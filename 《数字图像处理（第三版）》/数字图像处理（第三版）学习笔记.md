# 《数字图像处理》学习笔记

第三版（暂时没有买到纸质版），准备买第四版的纸质版，但是因为疑似双十一的原因还是什么的，说是11月8日送到，如今还是没有。。
灰度变换和空间滤波、频率域中的傅里叶变换和滤波、图像增强、图像复原、计算机断层、模糊集合、彩色图像处理、小波、图像和视频压缩、形态学处理、图像分割、图像描述、目标识别。

## 第1章 绪论

**引言**

**1.1 什么是数字图像处理**

​		强度或灰度，数字图像，图画元素、图像元素或像素
​		图像分析（图像理解）

​		百度上说：图像处理是图到图、图像分析是图到其他、计算机图形学是其他到图

**1.2 数字图像处理的起源**

**1.3 使用数字图像处理领域的实例**

​		图像（伽马射线、X射线、紫外、可见光和红外、微波、无线电、其他）

**1.4 数字图像处理的基本步骤**

​		1）输入输出都是图像
​		2）输入可能图像，输出是提取的属性
​		图像获取：包括图像预处理（例如缩放）
​		图像增强：主观，更加适合特定应用
​		图像复原：客观，退化
​		彩色图像处理
​		小波：不同分辨率
​		压缩：存储、带宽
​		形态学处理：提取分量
​		分割
​		表示与描述（特征选择）
​		识别：标志
​		知识库。。

**1.5 图像处理系统的组成**

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\图像处理系统.PNG" style="zoom: 67%;" />

​		感知：物理设备、数字化器
​		专用图像处理硬件：例如ALU（算术逻辑单元）。前端子系统
​		计算机
​		软件
​		大容量存储：短期（计算机内存、存储版或帧缓存）、在线、档案。
​				帧缓存允许瞬时缩放、滚动和摇动					
​		图像显示器
​		硬拷贝：打印等
​		网络

## 第2章 数字图像基础

#### **引言**

#### 2.1 视觉感知要素

**人眼**
		人眼的结构：角膜、巩膜外壳、脉络膜、视网膜、睫状体、虹膜、晶状体。
		视网膜上有锥状体（白昼视觉或亮视觉）和杆状体（暗视觉或微光视觉），分布中央凹对称，杆状体20度左右最大或者盲点
		盲点认为是直径1.5mm的圆形凹坑，中央凹认为是1.5mm×1.5mm的方形传感器阵列。
		与一个中等分辨率的电荷耦合元件成像芯片具有的元素相当，接收器阵列不大于5mm×5mm。
		![](F:\学习笔记（敲字人）\数字图像处理的一些图片\人眼.PNG)

​		主观亮度是进入人眼的光强的对数函数。
​		亮度适应现象。**亮度适应级别（不是很理解）**
​		韦伯比（亮度辨别能力，反）。。
​		马赫带（边界处带有毛边的亮度模式）、同时对比（例如背景亮度变化影响物体），视错觉。

#### **2.2 光和电磁波谱**

​		λ=c/v
​		E=hυ
​		![](F:\学习笔记（敲字人）\数字图像处理的一些图片\光谱.PNG)

​		0.43微米（紫）-0.79微米（红）
​		紫、蓝、绿、黄、橘黄、红
​		单色光或无色光：强度，灰度级（单色图像又称灰度图像）
​		描述彩色光源的质量：发光强度（总量，W）、光通量（感知到的，lm）和亮度
​		近红外、远红外

#### **2.3 图像感知和获取**

​		光传感器
​		单个传感器：鼓的转动、微密度计（平面床两个方向移动）、反射
​		条带传感器：条带、圆环（医学和工业计算机轴向断层CAT成像、核磁共振成像MRI、正电子发射断层PET成像）
​		传感器阵列：摄像机CCD阵列

​		简单的图像形成模型：
​		**f(x, y) = i(x, y)r(x, y)**
​		（i：入射分量，0到∞；r：反射分量，0到1，全吸收与全反射）
​		透射时，用透射系数代替反射系数
​		L = f(x0, y0)，范围Lmin到Lmax，区间称为灰度级或强度级，通常令其为[0, L-1]，黑到白

#### 2.4 图像取样和量化

​		取样：对坐标值进行数字化（分坐标）
​		量化：对幅值数字化（离散）

​		二维阵列，xy为离散坐标，x=0到M-1，y=0到N-1
​		空间域、空间变量或空间坐标

表示f(x, y)的三种基本方法：函数图，颜色，矩阵
矩阵中每个元素称为图像单元、图像元素或像素
		（原点左上角）

通常离散灰度技术限制为2的整数次幂（2^k）

​		动态范围：系统中最大可度量灰度与最小可检测灰度之比

​			饱和度：超过这个值的灰度级将被剪切掉

​			噪声：一个下限

​		对比度：最高和最低灰度级间的灰度差

​		存储比特数：b=M×N×k
​		k比特画像（2^k个灰度级）

​		空间分辨率：每单位距离线对数和每单位距离点数（像素数），1/2W（W为线宽，需要特别注意需要在空间单位中才有意义，与图片大小无关），每英寸点数dpi

​		灰度分辨率：灰度级中可分辨的最小变化，用于量化灰度的比特数。（注意可分辨的真实变化受到噪声和饱和度值的影响，还有人类感知能力的影响）

伪轮廓通常在以16或更少级数的均匀设置的灰度级显示的图像中十分明显。

一般认为，尺寸256×256，64灰度级，5cm×5cm上的图像具有最低空间和灰度分辨率，没有令人讨厌的取样棋盘格和伪轮廓。

​		等偏爱曲线

​		图像内插：图像重采样方法
​		最近邻内插法：最近邻的灰度赋给新位置，但是可能有直边缘的严重失真。
​		双线性内插（不是线性内插）：4个最近邻来估计，即
​					v(x, y) = ax + by + cxy + d
​		（系数由四个最近邻点写出的未知方程确定）
​		双三次内插：包括16个最近邻点，即

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\双三次内插.PNG)

​		（如果上下限为0-1，则为双线性内插）

​		采用样条和小波

#### 2.5 像素间的一些基本关系

​		相邻像素：水平和垂直4个，$\textcolor{red}{p的4邻域}$
$$
N_4(p)
$$
​		如果在边界上，则相邻像素位于内部。
​		对角相邻像素：
$$
N_D(p)
$$
​		一起合称p的8邻域
$$
N_8(p)
$$

​		V是定义邻接性的灰度值集合，二值图像中，具有1值的像素为邻接像素，V={1}；灰度图像范围0-255中，V可能为256值的任何一个子集。

​		4邻接、8邻接、m邻接（混合邻接，消除二义性）
​		m邻接：（1）q在N_4(p)中
​						（2）q在N_D(p)中，而且N_4(p)和N_4(q)的并没有V中数值的像素（无交集）
​					按照我的理解，就是先4，然后如果是D，再看看		



<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\邻接.PNG" style="zoom: 67%;" />

​		像素序列，通路长度，闭合通路，
​		连通，连通分量，连通集（仅有一个连通分量）
​		区域（连通），
​		邻接区域（两区域可联合形成连通集）
​		不连接区域
​		图中K个不连接的区域，且不接触边界，并集${R_u}$中所有点为图像的前景，补集${(R_u)^c}$为背景
​		区域R的边界（或边缘或轮廓），与R补集中的点邻近的点集合。（至少有一个背景邻点的像素集合）注意邻近方式（8连通）
​		内边界，外边界（背景边界）

边缘由某些超过预先设定的阈值的导数值的像素形成。

​		距离
​		欧几里得（欧式）距离：平方和，根号
​		（小于等于形成圆）
​		D_4距离（城市街区距离）：绝对值和
​		（小于等于形成菱形）
​		D_8距离（棋盘距离）：绝对值最大值
​		（小于等于形成方形）
​		D_m考虑m邻接，距离用最短通路

#### 2.6 数字图像处理中所用数学工具的介绍

​		矩阵操作
​		线性操作和非线性操作
​		算子H：H[f(x, y)] = g(x, y)
​		线性特性：加性（加法），同质性（数乘）

​		**算术操作**
​		针对降噪的带噪图像相加（平均）
​		增强差别的图像相减
​				模板模式放射成像的医学成像领域
​		使用图像相乘和相除来校正阴影
​				阴影校正、模板操作（感兴趣区域ROI操作，也就是单独拿出一个区域）
​		算术操作值域落入某个固定比特数的方法：
​				先减掉最小值，保证最小值为0：f_m = f - min(f)
​				再除以最大，乘K，映射：f_s = K [f_m / max(f_m)]	

​		注意除法操作需要先加上一个较小的数，避免除零

​		**集合操作**
​		灰度值的并集和交集操作分别定义为相应像素对的最大和最小（max和min）
​		补集操作定义为常数与图像中每个像素的灰度间的两两之差
​		（K-z）
​		图像灰度的集合操作

​		**逻辑操作**——用于图像形态学

​		模糊集合（使用隶属度函数）
​		比如不要非0即1，而是概率，例如年轻度为50%

​		**空间操作**
​		单像素操作：s = T(z)
​		邻域操作：例如图像局部模糊，可消除小的细节，并在图像中相应的大区域实施“斑点”补偿
​		几何空间变换和像素校准：橡皮膜变换
​				几何变换包括：坐标的空间变换，灰度内插
​				(x, y) = T{(v, w)}
​				仿射变换（尺度、旋转、平移和偏移）				

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\仿射.PNG)

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\公式.PNG" style="zoom: 67%;" />

​		前向映射、反向映射

​		图像旋转与灰度内插
​		图像配准：使用约束点（控制点），已知点（网状标记），估计变换函数。->拟合

​		**向量与矩阵操作**
​		向量和点的欧式距离D，二维欧式距离，向量范数
​		矩阵乘列向量
$$
g = Hf + n
$$
​		f表示输入图像的MN×1向量，n表示M×N噪声模式的MN×1向量，g表示处理后图像的MN×1向量。
​		H是用于对输入图像进行线性处理的MN×MN矩阵。

​		**图像变换**
​		正变换核，变换变量，正变换
​		反变换核，变换对
![](F:\学习笔记（敲字人）\数字图像处理的一些图片\变换.PNG)



​		空间域变换到变换域执行指定任务，再反变换回到空间域
![](F:\学习笔记（敲字人）\数字图像处理的一些图片\变换2.PNG)

​		可分：r(x, y, u, v) =  r_1(x, u)r_2(y, v)
​		对称：r_1(x, y) = r_2(x, y)

​		**（不是很理解）被正弦干扰污染的图像，对应的模板图像或者叫滤波器，图形是圆形的？**
​		**离散傅里叶变换对？第4章会讲更多**

​		当变换对正反变换满足可分和对称，且f是M×M方形图像，有**T = AFA**
​		F是f的M×M矩阵，A是a_ij = r_1的M×M矩阵，T是M×M变换的结果。
​		反变换B：**BTB = BAFAB**，若B = A的逆，**F = BTB**

​		其他变换：**沃尔什变换、哈达玛变换、离散余弦变换、哈尔变换和斜变换（不理解）**

​		**概率方法**
​		平均灰度、灰度方差（z值关于均值的展开度的度量，是图像对比度的有用度量）、第n阶矩（0阶为1，1阶为0，2阶为方差）
​		正三阶矩指出灰度倾向于比均值高，负三阶矩则相反，零三阶矩则说明灰度近似相等地分布在均值的两侧。
​		图像灰度对比度度量时标准差值的比较
​		

​		利用概率度量推导灰度变换
​		使用概率和矩阵公式开发图像复原算法
​		概率用于分割
​		概率用于描述纹理
​		以概率公式为基础，导出最佳目标识别技术

​		随机图像处理技术（序列图像，增加时间维度）
​		同态滤波




## 第3章 灰度变换与空间滤波

#### 引言

​		空间域：图像平面本身，相对于变换域。空间域处理分为灰度变换和空间滤波。
​		灰度变换在图像的单个像素上操作，主要以对比度和阈值处理为目的
​		空间滤波涉及改善性能的操作，例如通过图像每一个像素的邻域处理来锐化图像
​		模糊技术

#### 3.1 背景知识

​		空间域处理：g(x, y) = T[f(x, y)]
​		f为输入图像，g为处理后的图像，T是在点的邻域上定义的关于f的一种算子

​		空间滤波（一个简单的例子，就是3×3求平均）
​		空间滤波器（或空间掩模、核、模板、窗口）：邻域与预定义的操作
​		如果变成了1×1，则T变成灰度（灰度级或映射）变换函数：s = T(r)
​		对比度拉伸（低于k更暗，高于k更亮）
​		阈值处理函数：极限情况产生两级（二值）图像
​		点处理技术：结果仅取决于一个点处的灰度
​		邻域处理技术

在这里重点的是图像增强

#### 3.2 一些基本的灰度变换函数


​		线性函数（反转和恒等变换）、对数函数（对数和反对数变换）、幂律函数（n次幂和n次根变换）

​		**图像反转**
​		s = L - 1 - r
​		适用于增强嵌入在一幅图像的暗区域中的白色或灰色细节

​		**对数变换**
​		s = c log(1+r)		c为常数，r大于等于0
​		将输入中范围较窄的低灰度值映射为输出中较宽范围的灰度值，相反的，对高的输入灰度值也是如此。
​		（按照我的理解，就是拉长输入中较小的，压缩输入中较大的）
​		反对数变换相反

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\灰度变换函数.PNG" style="zoom:80%;" />

​		对数函数会压缩像素值变化较大的图像的动态范围（较大动态范围例如**傅里叶频谱**）

​		**幂律（伽马）变换**
​		${s = cr^γ}$		其中c和γ都是正常数

​		${s = c(r+ε)^γ}$		考虑偏移量

​		变化效果参考上图，和对数类似
​		但是，随着γ变化，可以得到一族曲线，大于和小于1的效果相反，再为1时简化为恒等变换
​		幂律方程中的指数称为伽马，
​		校正幂律响应现象的处理叫伽马校正

​		使用幂律变换进行对比度增强
​		幂律变换的另一个说明，输入有“冲淡”的图

​		**分段线性变换函数**
​		优点：可以任意复杂；缺点：技术说明要求用户输入
​		对比度拉伸
​		灰度级分层：突出特定灰度范围的亮度
​		比特平面分层：比如8位就分为8个图，用于量化该图像的比特数的充分性，对图像压缩也有用。
​		

#### 3.3 直方图处理

​		${h(r_k) = n_k}$
​		r_k是第k级灰度值，n_k是图像中灰度为r_k的像素个数
​		归一化直方图后，p(r_k) = n_k / MN是灰度级r_k在图像中出现概率的一个估计
​		直方图可以用于图像增强，图像压缩和分割

​		暗图像中，直方图分量集中在灰度级的低（暗）端
​		亮图像中，直方图分量则倾向于灰度级的高端
​		低对比度图像直方图窄，而且集中在中部
​		高对比度则是覆盖很宽的灰度级范围，一般均匀一些
​		（均匀，占据整个→高对比度，细节丰富，动态范围较大）

​		**直方图均衡（有点绕）**
​		s = T(r)
​		a）严格单调递增（保证反函数也递增）
​		b）r和T(r)范围都是0到L-1
$$
p_s(s) = p_r(r)\lvert \frac{dr}{ds} \rvert
$$
​		
$$
s = T(r) = (L-1)\int_0^r {p_r(w)} \,{\rm d}w
$$
​		概率密度函数PDF
​		累积分布函数CDF
$$
\frac{ds}{dr} = (L-1)p_r(r)
$$

$$
p_s(s) = \frac{1}{L-1}
$$

​		s在0到L-1之间（包含）
​		说明T取决于p_r，但是p_s始终均匀，与p_r无关
​		离散同理

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\离散直方图均衡.PNG)

​		T(r_k)称为直方图均衡或直方图线性变换

​		（我的理解就是因为之前的概率分布挺偏，但是考虑到累积积分之后，呈现的是从0到L-1，而且累积的数各不相同，所以就借助累积的积分，映射到全新的范围中）

​		直方图均衡

​		**直方图匹配（规定化）**
​		直方图匹配（或直方图规定化）：处理后的图像具有规定的直方图形状
​		r为输入，z为输出

​		1）由输入得到p_r(r)，由s = T(r) = (L-1)积分(0-r)p_r(w)dw，得到s
​		2）G(z) = (L-1)积分(0-z)p_z(t)dt = s，得到G(z)
​		3）求反函数z = G^-1(s)
​		4）按照1）进行均衡
​		**（这里感觉挺难的，看到有资料说，就是先均衡，再根据目标反变换就可以）**

​		离散步骤：
​		1）四舍五入
​		2）求G（规定的直方图），四舍五入，存储在表中
​		3）反向，查表找映射，不唯一取最小
​		4）均衡，结合3）的映射，规定化

​		G应该是严格单调的，否则按照3

​		直方图均衡与直方图匹配的比较

​		**局部直方图处理**
​		每个像素的邻域的灰度分布为基础设计变换函数
​		注意“棋盘”效应

​		局部直方图均衡

​		**在图像增强中使用直方图统计**
​		均值（平均灰度），灰度方差（图像对比度）
​		取样均值，取样方差（这里没考虑无偏估计）

​		直方图统计计算

​		使用直方图统计的局部增强
​		局部均值m_S_xy，全局均值m_G，类似有方差

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\局部增强.PNG)

​		E = 4.0，k_0 = 0.4，k_1 = 0.02，k_2 = 0.4

#### 3.4 空间滤波基础

​		下一章中，滤波用于频率域处理。通过低频的滤波器称为低通滤波器，效果是模糊（平滑）图像。
​		空间滤波器（空间掩模、核、模板、窗口）也可以类似的平滑，线性空间滤波与频率域滤波之间有一一对应的关系。
​		空间滤波还可以用于非线性滤波，这在频率域中做不到。

​		**空间滤波机理**
​		空间滤波器包括：一个邻域，对该邻域包围的图像像素执行的预定义操作
​		线性空间滤波器、非线性空间滤波器（5.3）

​		在这里更加关注奇数尺寸的滤波器（最小3×3），因为中心落在整数位置上。

​		**空间相关与卷积**
​		相关是滤波器位移的函数（相关的第一个值对应滤波器的零位移等等）

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\相关和卷积.PNG)

​		离散单位冲激：包含单个1而其余都是0
​		一个函数与离散单位冲激相关，在该冲激位置产生这个函数的一个翻转版本

​		卷积需要旋转180度

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\相关和卷积2.PNG)

​		相关还可以用于寻找图像中的匹配（12章）

​		m×m滤波器w(x, y)和图像f(x, y)相关操作：
​		${w(x, y)☆f(x, y) =  \sum_{s=-a}^a \sum_{t=-b}^b w(s,t)f(x+s,y+t) \quad}$
​		a = (m-1) / 2，b = (n-1) / 2

​		卷积操作：
${w(x, y)★f(x, y) =  \sum_{s=-a}^a \sum_{t=-b}^b w(s,t)f(x-s,y-t) \quad}$

​		卷积满足交换律，但是相关不满足交换律

​		一个函数与单位冲激的卷积，相当于在单位冲激的位置处复制该函数（第4章）

​		**线性滤波的向量表示**

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\R.PNG)

​		相关和卷积的模板的响应特性R
​		w为m×n的滤波器的系数，z为由滤波器覆盖的相应图像的灰度值

​		**空间滤波器模板的产生**
​		类似正态分布函数那样子，有高斯函数，用于高斯滤波

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\高斯.PNG" style="zoom: 67%;" />

#### **3.5 平滑空间滤波器**

​		平滑滤波器用于模糊处理和降低噪声

​		**平滑线性滤波器**
​		均值滤波器：滤波器模板邻域内像素的简单平均值，归入低通滤波器
​		降低图像灰度的“尖锐”变化，但是边缘模糊的负面效应
​		均值滤波器主要用于去除图像中的不相关细节（与滤波器模板尺寸相比较小的像素区域）

​		盒状滤波器：所有系数都相等的空间均值滤波器

​		加权均值滤波器：

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\加权均值滤波器.PNG" style="zoom: 67%;" />

​		使用各种尺寸模板的图像平滑

​		**统计排序（非线性）滤波器**
​		中值滤波器对处理脉冲噪声（椒盐噪声）非常有效
​		（类似中位数的概念）
​		作用：使拥有不同灰度的点看起来更接近于它的相邻点
​		最小值滤波器，最大值滤波器

​		利用中值滤波降噪
​		中值滤波比均值滤波更适合去除椒盐噪声

#### 3.6 锐化空间滤波器

​		锐化处理的主要目的是突出灰度的过渡部分
​		均值或积分用于模糊，空间微分用于锐化
​		微分算子的响应强度与图像在用算子操作的这一点的突变程度成正比
​		图像微分增强边缘和其他突变（如噪声），而削弱灰度变化缓慢的区域

​		**基础**
​		一阶和二阶微分
​		差分：二阶微分 = f(x+1) + f(x-1) - 2f(x)
​		零交叉在边缘定位中很有用（二阶微分为0之类的）
​		二阶微分在增强细节方面要比一阶微分好得多

​		**使用二阶微分进行图像锐化——拉普拉斯算子**
​		各向同性滤波器：旋转不变的
​		最简单的各向同性微分算子是拉普拉斯算子，二维图像f(x, y)的拉普拉斯算子：

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\拉普拉斯.PNG)

​		如果再考虑上对角线，-8，45度增幅是各向同性
​		同时符号可以取反，注意符号的区别！
​		负的中心系数，则减去变换后的图像，而不是加，得到锐化结果
​		**g(x, y) = f(x, y) + c拉普拉斯**
​		中心为-4，-8，c取-1，否则，1

​		使用拉普拉斯的图像锐化

​		**非锐化掩蔽和高提升滤波**
​		非锐化掩蔽：原图像中减去一幅非锐化（平滑过的）版本
​		1）模糊原图像
​		2）从原图像中减去模糊图像（产生的差值图像称为模板）
​		3）将模板加到原图像上

​		g_mask(x, y) = f(x, y)-f^-(x, y)（暂时打不出来上横线）
​		g(x, y) = f(x, y) + k*g_mask(x, y)
​		当k = 1，非锐化掩蔽
​		当k > 1，高提升滤波
​		当k < 1，不强调非锐化模板的贡献
​		（k值不能过大）

​		使用非锐化掩蔽进行图像锐化

​		**使用一阶微分对（非线性）图像锐化——梯度**
​		梯度（也即是对xy分量分别求微分），指出f最大变化率的方向
​		长度为M(x, y) = mag(▽f) = 对分量的平方和根号（非线性）
​		M的图像叫做梯度图像
​		但是这样子梯度中的偏微分并不是旋转不变的，只是梯度向量的幅度旋转不变
​		也有用绝对值求和的方式代替平方和根号，但是会丢失各向同性

​		离散的情况，求差分代替微分
​		（例如g_x = z_9 - z_5，g_y = z_8 - z_6，注意！交叉而不是上上下下）

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\离散梯度.PNG)

​		上图中间叫做：罗伯特交叉梯度算子
​		上图右侧叫做：Sobel算子

​		使用梯度进行边缘增强

#### 3.7 混合空间增强法

​		结合多种图像增强方法
​		例如：先拉普拉斯突出小细节，再梯度突出边缘，掩蔽，灰度变换增大动态范围
​		因为拉普拉斯容易导致更多噪点，所以梯度，再均值滤波平滑处理，再与拉普拉斯相乘

#### 3.8 使用模糊技术进行灰度变换和空间滤波

​		**引言**
​		隶属度函数（特征函数），在处理二值逻辑时，简单定义阈值，比如小于20岁为年轻人，这就对20岁零1秒有点。。
​		增加连续的渐进过渡

​		**模糊集合论原理**
​		Z为元素（对象）集，z表示Z的一类元素，Z = {z}，论域
​		模糊集合A由隶属度函数μ _ A(z)表征，表示元素相关在[0, 1]的一个实数
​		1完全成员，0不是成员，0到1部分成员
​		A = {z, μ _ A(z) | z属于Z}
​		空集：隶属度哈数为0
​		相等：μ相等
​		补集（NOT）：1-μ
​		子集：μ小于等于
​		并集（OR）：max
​		交集（AND）：min

​		模糊集合定义的说明
​		注意：模糊逻辑完全不是概率，是表示隶属度

​		**一些隶属度函数**
![](F:\学习笔记（敲字人）\数字图像处理的一些图片\隶属度1.PNG)

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\隶属度2.PNG)

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\隶属度3.PNG)

​		注意钟形是对S形的一些修改

​		S形很重要，z = b叫做交叉点，b = (a+c) / 2
​		钟形中，b叫做曲线的带宽

​		**模糊集合应用（有点难，举的例子有点怪）**
​		IF-THEN：前提（条件）——后果（结论）
​		推断或推理

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\模糊的水果.PNG)

​		1）模糊输入：每个标量输入，映射到0到1，使用隶属度函数，找到模糊值
​		2）执行任何需要的模糊逻辑操作：最大（OR）或最小（AND）操作
​		3）应用一种推断方法：AND最小，修建隶属度函数
​		4）应用聚合方法：OR最大
​		5）去模糊，计算**重心**

​		λ_i = min{***}表示第i条规则的强度水平（或点火水平）

​		**使用模糊集合进行灰度变换**
​		对比度增强

​		使用基于规则的模糊集的对比度修改的图像增强的说明

​		**使用模糊集合进行空间滤波**

​		使用基于规则的模糊集合的空间滤波增强边缘的说明



## 第4章 频率域滤波

#### 引言

​		混淆

#### 4.1 背景

​		周期和非周期函数（曲线下面积有限）都可以傅里叶变换
​		快速傅里叶变换算法（FFT）

#### 4.2 基本概念

​		四象限反正切函数计算复数的角度（-pi到pi，不然只有原来的一半，主要是通过追踪符号完成）mat lab中的atan2
​		复数基本表示、极坐标、欧拉公式
​		复函数

​		傅里叶级数

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\傅里叶级数.PNG" style="zoom:80%;" />

​		线性系统和傅里叶变换研究的核心是冲激及其取样特性
​		（冲激并不是通常意义的函数，更加准确的名称是分布或广义函数，但是有时会看到冲激函数、δ函数和狄拉克δ函数）

​		以下积分表达式过多，仅记录一小部分

​		连续变量t在0处单位冲激δ(t)，在0时取值无穷，其他取值0
​		满足全域积分为1
​		可以认为是幅度无限，持续时间为0，具有单位面积的尖峰信号
​		冲激具有取样**sifting**特性，即f(t)δ(t)在全域上积分为f(0)
​		更加一般地，f(t)δ(t-t_0)在全域上积分为f(t_0)

​		单位离散冲激，即δ(x)不取无穷，而是取1
​		其余性质与上文类似
​		但是与连续不同，离散冲激是一个普通函数

​		冲激串${s_{ΔT}(t)}$为无限多个分离的周期冲激单元ΔT之和：

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\冲激串.PNG" style="zoom: 67%;" />

​		（其中冲激可以是连续或离散的）

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\傅里叶变换对.PNG)

​		傅里叶变换对

​		如果f(t)是实数，则变换通常为复数。
​		因为傅里叶变换中唯一变量是频率，所以变换域是频率域
​		μ单位取决于t的单位（t秒——μ周/秒，t米——μ周/米）
​		（t用于说明图像，t的域为空间域）

​		求一个简单函数的傅里叶变换
​		sinc函数：sinc(m) = sin(pi m) / (pi m)
​		（sinc(0) = 1）
​		通常傅里叶变换包含复数项，所以通常处理幅值（或者叫傅里叶谱或频谱）

​		冲激和冲激串的傅里叶变换
​		一个位于空间域原点的冲激的傅里叶变换，在频率域是一个常数
​		冲激串可以表示为傅里叶级数
​		周期为ΔT的冲激串的傅里叶变换还是冲激串，周期为1/ΔT

​		具有连续变量t的两个连续函数的卷积
$$
f(t)★h(t) = \int_{-∞}^∞ {f(τ)h(t-τ)} \,{\rm d}τ
$$
​		空间域中两个函数的卷积的傅里叶变换等于两个函数的傅里叶变换在频率域中的乘积
​		f(t)★h(t)与H(τ)F(τ)是傅里叶变换对
​		f(t)h(t)和H(τ)★F(τ)也是
​		合称卷积定理

#### 4.3 取样和取样函数的傅里叶变换

​		**（有点难理解）**
​		模拟取样的一种方法是用ΔT单位间隔的冲激串作为取样函数乘以f(t)，得到f(t)（f bar，上波浪线）
​		取样率/采样率为1 / ΔT（取样数 / 秒或米等）

​		过取样、临界取样和欠取样

​		**取样定理**
​		以原点为中心的有限区间（带宽）[-μ _ max,  μ _ max]之外的频率值，傅里叶变换为零的函数f(t)称为**带限函数**

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\取样.PNG)

​		下三个图中，如果能够分离出来F(μ)的一个拷贝，就可以从取样后的版本复原f(t)，需要保证1/2ΔT > μ _ max，或者1/ΔT > 2μ _ max

​		**取样定理**：如果超出函数最高频率的两倍的取样率来获得样本，连续的带限函数可以完全地从它的样本集中来恢复

​		完全等于最高频率的两倍的取样率，称为**奈奎斯特取样率**
​		取样定理规定了取样率必须超过奈奎斯特取样率

​		H(μ) = ΔT（在-μmax到μmax之间，其他的值为0），称为低通滤波器（因为通过频率范围低的频率），理想低通滤波器（因为有“突变的台阶”）
​		用于从函数的取样恢复（重建）原始函数的目的的滤波器称为重建滤波器

​		**混淆**
​		由函数欠取样导致的变换被邻近周期的频率破坏、反变换产生t的一个破坏了的函数，频率混淆，混淆

​		没有有限持续时间的函数是带限的，一个带限函数一定从负无穷到无穷
​		说明用有限长度的取样和记录工作，混淆是一个不可避免的事情

​		抗混淆：通过平滑输入函数减少高频分量的方法（例如对图像采用散焦方法）减低混淆的影响，必须在函数被取样之前完成

​		混淆
​		1个周期/秒定义为1Hz

​		**由取样后的数据重建（复原）函数**
​		F(μ) = H(μ)F波浪(μ)
​		f(t) = 求和从负无穷到无穷f(nΔT)sinc[(t-nΔT) / ΔT]

#### 4.4 单变量的离散傅里叶变换（DFT）

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\离散傅里叶.PNG)

​		离散傅里叶变换（上）
​		傅里叶反变换（IDFT）：

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\傅里叶反变换.PNG" style="zoom:67%;" />

​		组成离散傅里叶变换对

​		离散傅里叶变换对适用于任何均匀取样的有限离散样本集

​		二维情况下，用xy表示图像坐标变量，用uv表示频率变量
​		F(u)，f(x)
​		连续时，tz表示空间变量，uv表示频率域变量

​		一维DFT对

​		傅里叶正变换和反变换都是无限周期的，周期为M

​		循环卷积：函数周期，卷积也是周期，但是只给出一个周期，在其内在处理

​		**取样和频率间隔间的关系**
​		DFT的频率分辨率Δu取决于连续函数f(t)被取样的持续时间T，并且DFT跨越的频率范围取决于取样间隔ΔT

​		计算DFT的机理

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\DFT.PNG)

​		**（按照我的理解，重要的是会公式的运用！）**

#### 4.5 两个变量的函数的扩展

​		**二维冲激及其取样特性**
​		与一维类似

​		**二维连续傅里叶变换对**

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\二维连续傅里叶.PNG)

​		μ和v的域定义了连续频率域

​		得到一个简单函数的二维傅里叶变换

​		**二维取样和二维取样定理**
$$
s_{ΔTΔZ}(t, z) = \sum_{m=-∞}^∞ \sum_{n=-∞}^∞ δ(t-mΔT,z-nΔZ)
$$
​		如果由区间[-μmax，μmax]和区间[-vmax，vmax]建立的矩形之外的傅里叶变换是零，则函数f(t，z)称为带限函数：
​		F(μ，v) = 0，|μ|>=μmax且|v|>=vmax

​		二维取样定理：取样间隔满足
​				ΔT<1 /  2μmax，ΔZ<1 /  2vmax
​		则连续带限函数f(t, z)可以由其一组样本无误地恢复。
​		或者说，如果一个二维带限连续函数在μ和v两个方向上由以大于该函数最高频率两倍的取样率取样获得的样本表示，则没有取样丢失

​		**图像中的混淆**
​		**从一维混淆中展开**
​		空间混淆和时间混淆：空间混淆由欠采样造成，时间混淆与图像序列中图像间的时间间隔有关
​		“车轮”效应（时间混淆）：车轮倒转

​		空间混淆主要表现为人为引入的缺陷，例如线状特征中的锯齿、伪高光及原图像中不存在的模式的出现

​		图像中的混淆

​		图像内插和重取样
​		二维内插最普通的应用之一是调整图像的大小（放大和缩小）。放大可以看成是过取样，缩小则可看成欠取样
​		不使用带限模糊方法对图像取样的过程称为抽取

​		重取样后的图像中的混淆的说明
​		欠取样类似行列删除法
​		处理具有很强边缘内容的图像时，混淆的影响看起来像是块状图像分量，称为**锯齿**

​		图像缩小中锯齿现象的说明

​		图像放大中锯齿现象的说明

​		**莫尔（波纹）模式**
​		半色调点：用黑色圆点或椭圆点，大小和变化的连接方式模拟灰色调

​		**二维离散傅里叶变换及其反变换**

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\二维离散傅里叶.PNG)

#### 4.6 二维离散傅里叶变换的一些性质

​		**空间和频率间隔的关系**
​		Δu = 1/MΔT		Δv = 1/NΔZ
​		频率域样本间的间隔与空间样本间的间距和样本数成反比

​		**平移和旋转**
​		指数项乘以f(x, y)将使DFT的原点移到点(u0, v0)
​		负指数项乘以F(u, v)将使f(x, y)的原点移到点(x0, y0)
​		平移不影响F的幅度（谱）
​		f(x, y)旋转角度，F(u, v)也旋转角度，反之一样

​		**周期性**
​		二维傅里叶和反变换在uv方向都是无限周期
​		(-1)^x乘f(x)将原点数据F(0)平移到[0, M-1]的中心位置
​		同理二维是乘以(-1)^(x+y)

​		**对称性**
​		函数分析告诉我们，任何实函数或虚函数可以分为一个奇数部分和一个偶数部分
​		偶函数对称，奇函数反对称
​		傅里叶比较（x，y）和（M-x，N-y）即可（关于中心）

​		偶函数和奇函数
​		任何4点偶序列必须满足第二点和最后一点相等即可
​		{a b c d}
​		而奇序列
​		{0 -b 0 b}
​		（M为偶数，位置0和M/2处总是0）

​		实函数f(x, y)的傅里叶变换是共轭对称的，即
​					F * (u, v) = F(-u, -v)
​		共轭对称也称为哈密特对称，反哈密特对称有时用于共轭反对称
​		虚函数的傅里叶变换是共轭反对称的，即
​					F * (-u, -v) = -F(u, v)

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\二维傅里叶奇偶性.PNG)

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\一些数据证明.PNG)

​		证明表中DFT的一些对称性质

​		**傅里叶谱和相角**
​		二维DFT一般是复函数，用极坐标表示，那么就有幅度，称为傅里叶谱（或频谱），arctan(I/R)称为相角

​		**功率谱定义为频谱的平方，即P = R ^ 2+I ^ 2**
​		实函数的傅里叶变换共轭对称，说明谱关于原点偶对称，相角关于原点奇对称
​		零频率项与f(x, y)的平均值成正比
​		典型地，|F(0, 0)|是谱的最大分量，因为原点处频率分量uv都是0，所以F(0, 0)有时称为变换的直流（dc）分量

​		一个简单函数的二维傅里叶谱

​		傅里叶谱和相角的进一步说明

​		**二维卷积定理**
​		注意卷积两个周期函数后也是周期的，周期的靠近使得他们互相干扰而导致所谓的缠绕错误
​		解决缠绕错误的方法：A个样本和B个样本的两函数f和h，如果把0添加到这两个函数中，使得他们具有相同的长度，用P表示：P>=A+B-1，可以避免缠绕
​		0可以添加到函数的开始，或者分别开始和结尾，但是结尾处更加简单
​		0填充

​		频率泄露：把0添加到函数上，创建了一个不连续的函数，盒子和函数相乘，在频率域上意味着原始变换和sinc函数卷积，造成一个由sinc函数的高频分量导致的频率泄露，会在图像上产生块效应
​		可以用另外函数乘以取样函数来减少，这个函数在取样数据的两端平滑过渡到解决于0，从而减弱盒子的（高频分量）急剧过渡。
​		图像重建希望保真度高时，应该考虑这种开窗或切趾
​		开窗较好的方法使用二维高斯函数

​		布特沃斯窗（一个简单的切趾函数是位于取样数据中心的三角形，会在取样数据的两端过渡到0）、汉明窗口、汉宁窗

### 		二维离散傅里叶变换性质的小结！！！

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\DFT1.PNG)

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\DFT2.PNG)

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\DFT3.PNG)

​		

#### 4.7 频率域滤波基础

​		**频率域的其他特性**
​		较高的频率开始对应于图像中越来越快的灰度变化
​		物体的边缘，或由灰度急剧变化来表征的其他图像分量

​		**频率域滤波基础**
​		修改一幅图像的傅里叶变换然后计算其反变换得到处理后的结果
​		${g(x,y)=\mathcal{F}^{-1}[H(u,v)F(u,v)]}$

​		H为滤波器或者滤波传递函数
​		使用中心对称的函数可以显著简化H的技术条件，要求F也被中心化。
​		如果H是实对称函数而f是实函数，IDFT理论上生成实数量，实际上因为误差会寄生复数项，通常取IDFT的实部形成g

​		低频与缓慢变化的灰度分量有关，高频与灰度尖锐过渡有关
​		衰减高频通过低频的低通滤波器用于模糊
​		相反的高通滤波器用于增强尖锐的细节，但是导致对比度降低
​		**（这里对填充的效果不是很明确）**

​		振铃现象：任何实现0填充的滤波器的空间截断会引入不连续性，在频率域中体现出来振铃现象

​		等同地影响实部和虚部而不影响相位的滤波器称为零相移滤波器

​		**频率域滤波步骤小结**

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\频率域滤波步骤1.PNG)

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\频率域滤波步骤2.PNG)

​		上图提到的公式：P>=2M-1和Q>=2N-1

​		**空间和频率域滤波间的对应**
​		纽带是卷积定理

​		h是空间滤波器，和H频率域滤波器形成傅里叶变换对（f=δ，让F=1）
​		因为h可以由H对一个冲激的响应得到，所以h有时称为H的脉冲响应
​		有限冲激响应（FIR）滤波器

​		频率域高斯滤波器
$$
H(u)=Ae^{-u^2/2σ^2}
$$
​		对应的空间域滤波器
$$
h(x)=\sqrt{2\pi}\sigma Ae^{-2\pi^2\sigma^2x^2}
$$
​		1）它们是一个傅里叶变换对，两个分量都是高斯的和实的函数
​		2）函数表现互易。H宽（σ大），h窄。σ接近无限，H接近常数，h接近冲激，意味着在频率域和空间域都不能滤波

​		还可以使用高斯函数的差来构造一个高通滤波器

$$
H(u)=Ae^{-u^2/2σ_1^2}-Be^{-u^2/2σ_2^2}
$$

$$
h(x)=\sqrt{2\pi}\sigma_1 Ae^{-2\pi^2\sigma_1^2x^2}-\sqrt{2\pi}\sigma_2 Be^{-2\pi^2\sigma_2^2x^2}
$$

​		其中A>=B，σ1>σ2

​		由小空间模板得到频率域滤波器

#### 4.8 使用频率域滤波器平滑图像

​		三种低通滤波器：理想滤波器、布特沃斯滤波器、高斯滤波器
​		布特沃斯滤波器有一个参数“阶数”，高阶接近理想滤波器，低阶接近高斯滤波器

​		H可以理解为大小为P×Q的离散函数，离散频率变量的范围是u从0到P-1，v从0到Q-1

​		**理想低通滤波器**
​		原点为圆心，${D_0}$为半径的圆内，无衰减地通过所有频率，而在圆外切断所有频率的二维低通滤波器，称为理想低通滤波器（ILPF）
$$
H(u,v) =
        \begin{cases}
            1,  & D(u,v)\leq D_0 \\
            0, & D(u,v)>D_0 \\
        \end{cases}
$$
​		D(u,v)为频率域中点(u,v)到频率矩形中心的距离
​		${D(u,v)=[(u-P/2)^2+(v-Q/2)^2]^{1/2}}$

​		ILFP横截面，再H=1和H=0之间的过渡点称为截止频率

​		总图像功率值${P_T}$为每点功率谱分量和得到
​		可以求得${D_0}$的圆内包含α%的功率

​		使用一个ILPF平滑图像
​		会出现振铃现象

​		**布特沃斯低通滤波器**
​		截止频率位于距原点${D_0}$处的n阶布特沃斯低通滤波器BLPF的传递函数定义为
$$
H(u,v)=\frac{1}{1+[D(u,v)/D_0]^{2n}}
$$
![](F:\学习笔记（敲字人）\数字图像处理的一些图片\布特沃斯滤波器.PNG)

​		截止频率点为${D(u,v)=D_0}$时的点，50%

​		使用布特沃斯低通滤波器平滑图像
​		没有可见的振铃现象
​		一阶没有振铃，二阶难以察觉振铃，但是更高阶会明显

​		**高斯低通滤波器**
​		GLPF
$$
H(u,v)=e^{-D^2(u,v)/2\sigma^2}\\
或者\\
H(u,v)=e^{-D^2(u,v)/2D_0^2}
$$
![](F:\学习笔记（敲字人）\数字图像处理的一些图片\高斯低通滤波器.PNG)

​		截止频率${D_0}$，下降到0.607
​		没有振铃

​		使用高斯低通滤波器平滑图像

​		**低通滤波的其他例子**
​		1）机器感知领域，字符识别：
​		模糊输入图像来桥接输入图像中的小裂缝
​		2）印刷和出版业
​		“美容”处理，减少皮肤细纹的锐化程度和小斑点
​		3）卫星图像和航空图像的处理

#### 4.9 使用频率域滤波器锐化图像

​		一个高通滤波器是从给定的低通滤波器用下式得到：
$$
H_{HP}(u,v)=1-H_{LP}(u,v)
$$
​		也是考虑理想、布特沃斯和高斯高通滤波器

​		**理想高通滤波器**IHPF
$$
H(u,v) =
        \begin{cases}
            0,  & D(u,v)\leq D_0 \\
            1, & D(u,v)>D_0 \\
        \end{cases}
$$

​		**布特沃斯高通滤波器**BHPF
$$
H(u,v)=\frac{1}{1+[D_0/D(u,v)]^{2n}}
$$
​		**高斯高通滤波器**GHPF
$$
H(u,v)=1-e^{-D^2(u,v)/2D_0^2}
$$


![](F:\学习笔记（敲字人）\数字图像处理的一些图片\高通滤波器.PNG)

​		使用高通滤波器法和阈值法增强图像
​		D_0大约为填充后图像的短维的2.5%，接近原点较为理想，因为这样子会衰减低频但是不会完全消除。D_0在短维的2%到5%是一个不错的起点

​		**频率域的拉普拉斯算子**
$$
H(u,v)=-4\pi^2(u^2+v^2)\\
或者\\
H(u,v)=-4\pi^2[(u-P/2)^2+(v-Q/2)^2]\\
=-4\pi^2D^2(u,v)
$$
​		具体怎么使用，参考之前的傅里叶变换和反变换，以及3.6节的拉普拉斯

​		f和拉普拉斯的差别会被带入到可比的范围**（？？？）**，解决办法：在计算f的DFT之前先归一化到0到1之间，在用最大值除拉普拉斯，从而带到-1到1范围内

​		使用拉普拉斯算子在频率域锐化图像

​		**钝化模板、高提升滤波和高频强调滤波**
​		也是参考3.6
$$
g_{mask}(x,y) = f(x,y)-f_{LP}(x,y)
$$

$$
f_{LP}(x,y)=\mathcal{F}^{-1}[H_{LP}(u,v)F(u,v)]
$$

$$
g(x,y)=f(x,y)+k*g_{mask}(x,y)
$$

$$
g(x,y)=\mathcal{F}^{-1}\{[1+k*[1-H_{LP}(u,v)]]F(u,v)\}
$$

$$
g(x,y)=\mathcal{F}^{-1}\{[1+k*H_{HP}(u,v)]F(u,v)\}
$$

​		高频强调滤波器（高通滤波器直流项为0，导致平均灰度减小为0，而高频强调滤波器增加了1）
​		更加一般的高频强调滤波器：
$$
g(x,y)=\mathcal{F}^{-1}\{[k_1+k_2*H_{HP}(u,v)]F(u,v)\}
$$
​		k_1>=0给出控制距原点的偏移量，k_2>=0控制高频的贡献

​		使用高频强调滤波增强图像
​		用高频强调和直方图均衡相结合得到的结果优于用任何单独方法得到的结果
​		医学图像不能接受振铃，所以用高斯

​		**同态滤波**
​		2.3的照射-反射模型：f=i×r
​		同时压缩灰度范围和增强对比度来改善一幅图像的表现
​		乘法的傅里叶变换并不是变换的乘积，但是我们可以取对数：z(x, y) = ln f(x, y) = ln i(x, y) + ln r(x, y)
​		那么就可以加法的傅里叶等于傅里叶的加法了！
​		（注意灰度范围有可能是从0到L-1，则必须加1处理，结束后再减掉）
$$
Z(u,v) = F_i(u,v)+F_r(u,v)
$$
​		最后反傅里叶，再取指数即可！
​		关键是照射分量和反射分量的分离！

​		由于照射分量慢，反射分量易突变，取对数后，低频照射，高频反射。
​		使用同态滤波器可以控制照射分量和反射分量，只需要改变H，例如变成：
$$
H(u,v) = (\gamma_H-\gamma_L)[1-e^{-c[D^2(u,v)/D_0^2]}]+\gamma_L
$$
![](F:\学习笔记（敲字人）\数字图像处理的一些图片\同态滤波器.PNG)

​		${\gamma_L<1}$且${\gamma_H>1}$，衰减低频照射，增强高频反射，同时进行动态范围的压缩和对比度的增强

​		使用同态滤波器增强图像

#### 4.10 选择性滤波

​		第一类滤波器称为带阻滤波器或带通滤波器
​		第二类滤波器称为陷波滤波器

​		**带阻滤波器和带通滤波器**

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\带阻滤波器.PNG)

​		D_0是带宽的径向中心，W是带宽
​		带通滤波器可以由带阻滤波器得到：
$$
H_{BP}(u,v)=1-H_{BR}(u,v)
$$
​		**陷波滤波器**
​		陷波滤波器拒绝（或通过）事先定义的关于频率矩形中心的一个邻域的频率
​		零相移滤波器关于原点对称，所以中心位于(u0,v0)的陷波在(-u0,-v0)处必须有一个对应的陷波
​		陷波带阻滤波器可以用中心已经平移到陷波滤波器中心的高通滤波器的乘积来构造：
$$
H_{NR}(u,v)=\prod_{k=1}^Q H_k(u,v)H_{-k}(u,v)
$$
​		H都是高通滤波器，中心位于(u_k,v_k)和(-u_k,-v_k)

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\陷波滤波器.PNG)

​		陷波带通滤波器可以由陷波带阻滤波器得到：
$$
H_{NP}(u,v)=1-H_{NR}(u,v)
$$
​		陷波滤波的主要应用之一就是选择性地修改DFT的局部区域，直接对DFT交互式处理，不需要填充

​		使用陷波滤波减少莫尔（波纹）模式

​		使用陷波滤波增强恶化的卡西尼土星图像

#### 4.11 实现

​		**二维DFT的可分性**

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\二维DFT拆分.PNG)

​		f的二维DFT可通过计算f的每一行的一维变换，然后，沿着计算结果的每一列计算一维变换得到
​		类似的扩展可用一维IDFT来计算二维IDFT

​		**用DFT算法计算IDFT**
$$
MNf^*(x,y) = \sum_{u=0}^{M-1} \sum_{v=0}^{N-1} F^*(u,v)e^{-j2\pi(ux/M+vy/N)}
$$
​		只要再乘1/MN，得到f，也就是F的反变换

​		**快速傅里叶变换（FFT）**
​		快速傅里叶变换可以将乘法和加法的次数从MN^2，降低到MN log_2 MN
​		逐次加倍方法：假定取样数是2的整数次幂

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\FFT.PNG)

​		对于任意的2的整数次幂的M，一个两点变换来自两个单点变换，一个4点变换来自两个两点变换，以此类推，直到M为2的整数次幂

​		**关于滤波器设计的一些注释**
​		固件硬件

## 第5章 图像复原与重建

#### 		引言

​		图像增强主要是主观过程，而图像复原大部分是客观过程
​		复原技术是面向退化模型的
​		图像去噪

#### 5.1 图像退化/复原过程的模型

​		退化过程被建模为一个退化函数和一个加性噪声项
​		对输入图像${f(x,y)}$进行处理，得到退化后的图像${g(x,y)}$，给定g和关于退化函数H的一些知识以及关于加性噪声项${\eta(x,y)}$的一些知识，获得原始图像的一个估计${\hat{f}(x,y)}$

​		g=h★f+η

​		h是退化函数的空间表示，★表示空间卷积

​		G=HF+N

​		等价的频率域，傅里叶变换

#### 5.2 噪声模型

​		**噪声的空间和频率特性**
​		频率特性：傅里叶域中噪声的频率内容（相当于电磁波谱的频率）
​		当噪声的傅里叶谱是常量时，噪声通常称为白噪声

​		空间周期噪声

​		暂时假设噪声独立于空间坐标，且噪声于图像本身不相关（像素值与噪声分量的值之间不相关）（注意在X射线和和医学成像的有限量子成像并不能做这个假设）

​		**一些重要的噪声概率密度函数**
​		可以认为空间噪声描述子就是噪声分量中灰度值的统计特性，由概率密度函数（PDF）表征的随机变量

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\PDF.PNG)

​		**高斯噪声**
​		或者叫正态噪声，在空间域和频率域中易处理
​		高斯随机变量z的PDF：
$$
p(z)=\frac{1}{\sqrt{2\pi}\sigma}e^{-(z-\bar{z})^2/2\sigma^2}
$$
​		z表示灰度值，${\bar{z}}$表示平均，${\sigma}$表示标准差，平方为方差
​		70%、95%、??（3sigma原则）

​		**瑞利噪声**
$$
p(z)=\begin{cases}
            \frac{2}{b}(z-a)e^{-(z-a)^2/b},  & z\geq a \\
            0, & z<a \\
        \end{cases}
$$
​		均值为${\bar{z}=a+\sqrt{\pi b/4}}$
​		方差为${\sigma^2=\frac{b(4-\pi)}{4}}$

​		距原点的位移和密度的基本形状向右变形，瑞利密度对于近似歪斜的直方图十分适用

​		**爱尔兰（伽马）噪声**
$$
p(z)=
\begin{cases}
\frac{a^bz^{b-1}}{(b-1)!}e^{-az},  & z\geq a \\
0, & z<a \\
\end{cases}
$$

​		均值为${\bar{z}=\frac{b}{a}}$
​		方差为${\sigma^2=\frac{b}{a^2}}$

​		伽马密度，但是严格地说，只有分母为伽马函数${\Gamma(b)}$才正确，在这里更应该叫做爱尔兰密度

​		**指数噪声**
$$
p(z)=
\begin{cases}
ae^{-az},  & z\geq 0 \\
0, & z<0 \\
\end{cases}
$$
​		a>0

​		均值为${\bar{z}=\frac{1}{a}}$
​		方差为${\sigma^2=\frac{1}{a^2}}$

​		这个PDF是当b=1时爱尔兰PDF的特殊情况

​		**均匀噪声**
$$
p(z)=\begin{cases}
\frac{1}{b-a}, & a\geq z\geq b\\
0,&其他
\end{cases}
$$
​		均值为${\bar{z}=\frac{a+b}{2}}$
​		方差为${\sigma^2=\frac{(b-a)^2}{12}}$

​		**脉冲（椒盐）噪声**
​		（双极）脉冲噪声PDF：
$$
p(z)=\begin{cases}
{P_a},&z=a\\
{P_b},&z=b\\
1-P_a-P_b,&其他\\
\end{cases}
$$
​		b>a，则灰度级b在图像中显示一个亮点，反之，a暗点
​		若P_a或P_b为零，则脉冲噪声称为**单极脉冲**
​		若两者均不可能为零，尤其是近似相等时，**椒盐噪声**
​		或者叫散粒噪声和尖峰噪声

​		可正可负，通常数字化最大值，正脉冲255白点盐粒，负脉冲0黑点胡椒

​		高斯噪声源于诸如电子电路噪声以及由低照明度和/或高温带来的传感器噪声
​		瑞利密度有助于在深度成像中表征噪声现象
​		指数密度和伽马密度在激光成像中很有用
​		脉冲噪声在快速过渡的情况下产生，例如错误开关操作
​		均匀密度最少，但是在仿真中使用的许多随机数生成器的基础很有用

​		噪声图像及其直方图
​		由脉冲噪声污染的图像的椒盐噪声的外观是唯一一种引起退化的、视觉上可区分的噪声类型

​		**周期噪声**
​		在图像获取期间由电力或机电干扰产生的，空间相关噪声
​		可通过频率域滤波来显著地减少

​		**噪声参数的估计**
​		周期噪声的参数是通过检测图像的傅里叶谱来估计的，周期噪声趋向于产生频率尖峰
​		图像条带的数据产生直方图，除了形状之外，还可以计算均值和方差

#### 5.3 只存在噪声的复原——空间滤波

​		唯一存在的退化是噪声，g=f+η
​		G=F+N

​		仅存在加性噪声的情况下，可以选择空间滤波方法

​		**均值滤波器**
​		**算术均值滤波器**
$$
\hat{f}(x,y)=\frac{1}{mn}\sum_{(s,t)\in S_{xy}}g(s,t)
$$
​		平滑一幅图像的局部变化，虽然模糊了结果，但是降低了噪声
​		**几何均值滤波器**
$$
\hat{f}(x,y)=[\prod_{(s,t)\in S_{xy}}g(s,t)]^{\frac{1}{mn}}
$$
​		与算术均值相比，丢失的图像细节更少

​		**谐波均值滤波器**
$$
\hat{f}(x,y)=\frac{mn}{\sum_{(s,t)\in S_{xy}}\frac{1}{g(s,t)}}
$$
​		对于盐粒噪声效果较好，但是不适用于胡椒噪声。善于处理类似高斯噪声

​		**逆谐波均值滤波器**
$$
\hat{f}(x,y)=\frac{\sum_{(s,t)\in S_{xy}}{g(s,t)}^{Q+1}}{\sum_{(s,t)\in S_{xy}}{g(s,t)}^Q}
$$
​		Q为滤波器的阶数，适用减少或在实际中消除椒盐噪声的影响，Q为正，消除胡椒，Q为负，消除盐粒。但是不能同时消除两种噪声
​		Q为0，算术均值滤波器，Q为-1，谐波均值滤波器

​		均值滤波器的说明
​		算术均值滤波器和几何均值滤波器（尤其几何）适合高斯或均匀随机
​		逆谐波均值滤波器更适合脉冲，但是必须选好Q，选错特别灾难！！！

​		**统计排序滤波器**
​		**中值滤波器**
$$
\hat{f}(x,y)=median_{(s,t)\in S_{xy}} \{g(s,t)\}
$$
​		对于某些随机噪声良好，比相同尺寸的线性平滑滤波器引起的模糊更少
​		在存在单极或双极脉冲噪声的情况下，中值滤波器尤其有效

​		**最大值和最小值滤波器**
​		最大值滤波器
$$
\hat{f}(x,y)=max_{(s,t)\in S_{xy}} \{g(s,t)\}
$$
​		对于发现图像中的最亮点非常有用，胡椒噪声值很低，可以降低

​		最小值滤波器
$$
\hat{f}(x,y)=min_{(s,t)\in S_{xy}} \{g(s,t)\}
$$
​		对于发现图像中的最暗点非常有用，降低盐粒噪声

​		**中点滤波器**
​		中点滤波器计算滤波器包围区域中最大值和最小值的中点
$$
\hat{f}(x,y)=\frac{1}{2}[max_{(s,t)\in S_{xy}} \{g(s,t)\}\\+min_{(s,t)\in S_{xy}} \{g(s,t)\}]
$$
​		结合了统计排序和求平均，对随机分布噪声最好，例如高斯噪声或均匀噪声

​		**修正的阿尔法均值滤波器**
​		去掉最低灰度值的d/2和最高灰度值的d/2
​		${g_r(s,t)}$是剩下的mn-d个像素，由这些像素的平均值形成的滤波器称为修正的阿尔法均值滤波器
$$
\hat{f}(x,y)=\frac{1}{mn-d}\sum_{(s,t)\in S_{xy}}g_r(s,t)
$$
​		d的范围可以从0到mn-1
​		0时退化为算术均值滤波器
​		mn-1时退化为中值滤波器
​		其他值，在包括多种噪声的情况下很有用，例如高斯噪声和椒盐噪声混合

​		统计排序滤波器的说明

​		**自适应滤波器**
​		自适应滤波器的性能要优于迄今为止讨论过的所有了不起的性能，但是代价是复杂度提高了
​		**自适应局部降低噪声滤波器**
​		a）g(x, y)，带噪图像在点上的值
​		b）${\sigma_\eta^2}$，污染f以形成g的噪声的方差
​		c）${m_L}$，S_xy中像素的局部均值
​		d）${\sigma_L^2}$，S_xy中像素的局部方差
$$
\hat{f}(x,y)=g(x,y)-\frac{\sigma_\eta^2}{\sigma_L^2}[g(x,y)-m_L]
$$
​		1）如果${\sigma_\eta^2}$为0，则返回g
​		2）如果两个sigma高度相关，则返回g的近似值，特别注意保护边缘
​		3）如果两个sigma相等，则返回均值
​		唯一想要知道或估计的是${\sigma_\eta^2}$
​		隐含假设是${\sigma_\eta^2 \leq \sigma_L^2}$，所以大于时设置为1，非线性，防止无意义结果
​		另外一种方法是允许负值，但是最终重新标定，但是损失动态范围

​		自适应局部降低噪声滤波的说明
​		案例中，比算术和几何均值滤波器清晰

​		**自适应中值滤波器**
​		只要脉冲噪声空间密度不大（P_a和P_b小于0.2），之前的中值滤波器性能很好，但是更大概率的脉冲噪声，自适应中值滤波器可以处理
​		另外一个优点就是平滑非脉冲噪声时试图保留细节
​		自适应中值滤波器在进行滤波处理时会根据某些条件而改变（或增大）S_xy的尺寸
​		z_min最小灰度值，z_max最大灰度值，z_med中值
​		z_xy坐标处灰度值，S_max为S_xy允许的最大尺寸
​		两个进程同时工作

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\自适应中值滤波器两进程.PNG" style="zoom: 67%;" />

​		进程A确定z_med是不是脉冲，不是则转B
​		进程B看中心点是不是脉冲
​		不改变“中间灰度级”点，减少图像失真
​		如果输出z_med，说明像素值都是极端值
​		最后进行中值滤波。
​		随着脉冲密度增大，需要更大的窗口来消除尖峰噪声
​		（仅使用新像素即可反复关心中值，减少开销）

​		自适应中值滤波的说明

#### 5.4 用频率域滤波消除周期噪声

​		**带阻滤波器**

​		使用带阻滤波器消除周期性噪声
​		带阻滤波器的主要应用之一就是在频率域噪声分量的一般位置近似已知的应用中消除噪声

​		**带通滤波器**

​		使用带通滤波提取噪声模式
​		带通滤波器帮助屏蔽了噪声模式

​		**陷波滤波器**

​		用陷波滤波器消除周期性噪声

​		**最佳陷波滤波**
​		屏蔽干扰的主要成分，从被污染的图像中减去该模式的一个可变的加权部分
​		提取干扰模式的主频率分量：
$$
N(u,v)=H_{NP}(u,v)G(u,v)\\
\eta(x,y)=\mathcal{F}^{-1}\{H_{NP}(u,v)G(u,v)\}
$$
​		H_NP是陷波带通滤波器
$$
\hat{f}(x,y)=g(x,y)-w(x,y)\eta(x,y)
$$
​		w为加权函数或调制函数，优化
​		选取w使得${\hat{f}}$在每一点的指定邻域上方差最小
​		。。省略一些带入和推导，求方差，带入，求偏导为0，求解，最终得到：
$$
w(x,y)=\frac{\overline{g(x,y)\eta(x,y)}-\bar{g}(x,y)\bar{\eta}(x,y)}{\bar{\eta^2}(x,y)-{\bar{\eta}}^2(x,y)}
$$
​		如果w在邻域内假设为常量，不必每个xy都求，而是每个非重叠邻域内一点（中心点）求w即可，然后用于邻域内包含的所有像素点

​		最佳陷波滤波的说明

#### 5.5 线性、位置不变的退化

​		线性系统、加性（加法和H）、均匀性（常数相乘）
​		位置（或空间）不变系统：
$$
{H[f(x-\alpha,y-\beta)]=g(x-\alpha,y-\beta)}
$$
​		系统H的冲激响应：
$$
h(x,\alpha,y,\beta)=H[\delta(x-\alpha,y-\beta)]
$$

$$
g(x,y)=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(\alpha,\beta)H[\delta(x-\alpha,y-\beta)]d\alpha d\beta
$$

​		h通常称为点扩散函数（PSF）

​		第一类叠加（弗雷德霍姆）积分：
$$
g(x,y)=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(\alpha,\beta)h(x,\alpha,y,\beta)d\alpha d\beta
$$
​		表明：如果系统H对一个冲激的响应已知，则对于任意输入f的响应可以用上式计算。线性系统H完全可由其冲激响应来表征

​		如果位置不变，简化为：
$$
g(x,y)=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(\alpha,\beta)h(x-\alpha,y-\beta)d\alpha d\beta
$$
​		变成卷积积分。对于任意输入f，若已知线性系统的冲激响应，则可以计算出响应g，结果是冲激响应和输入函数的简单卷积

​		线性退化模型（含加性噪声）：
$$
g(x,y)=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(\alpha,\beta)h(x,\alpha,y,\beta)d\alpha d\beta+\eta(x,y)
$$
​		若H位置不变：
$$
g(x,y)=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(\alpha,\beta)h(x-\alpha,y-\beta)d\alpha d\beta+\eta(x,y)
$$
​		简化为：
$$
g(x,y)=h(x,y)★f(x,y)+\eta(x,y)\\
或者频率域中\\
G(u,v)=H(u,v)F(u,v)+N(u,v)
$$
​		图像去卷积：常用于表示线性图像复原
​		去卷积滤波器：用于复原处理的滤波器

#### 5.6 估计退化函数

​		观察法、试验法、数学建模法
​		盲目去卷积

​		**图像观察估计**
​		取一个由很强信号内容的子区域${g_s(x,y)}$
$$
H_s(u,v)=\frac{G_s(u,v)}{\hat{F_s}(u,v)}
$$
​		仅在特殊环境下使用的很麻烦的处理，例如复原一幅有历史价值的老照片

​		**试验估计**
​		使用相同的系统对一个冲激（小亮点）成像，得到退化的冲激响应
​		冲激的傅里叶变换是一个常量

​		**建模估计**
​		例如，基于大气湍流的物理特性${H(x,y)=e^{-k(u^2+v^2)^{5/6}}}$
​		k为0.0025剧烈，0.001中等，0.00025轻微

​		建模的另一个主要方法是从基本原理开始推导一个数学模型
​		例如图像获取时被图像与传感器之间的均匀线性运动模糊

​		由于运动引起的图像模糊
$$
H(u,v)=\frac{T}{\pi(ua+vb)}sin[\pi(ua+vb)]e^{-j\pi(ua+vb)}
$$


#### 5.7 逆滤波

$$
\hat{F}(u,v)=\frac{G(u,v)}{H(u,v)}
$$

$$
\hat{F}(u,v)=F(u,v)+\frac{N(u,v)}{H(u,v)}
$$

​		即使知道退化函数，也不能准确地复原未退化的图像，因为N未知。如果退化函数为0或者非常小，则N/H很容易支配${\hat{F}}$
​		解决办法是限制滤波频率，使其接近原点，减少遇到零值的概率

​		逆滤波
​		一般直接逆滤波的性能是较差的

#### 5.8 最小均方误差（维纳）滤波

​		综合了退化函数和噪声统计特征进行复原的方法
$$
\hat{F}(u,v)=[\frac{H^*(u,v)S_f(u,v)}{S_f(u,v)|H(u,v)|^2+S_\eta(u,v)}]G(u,v)\\
=[\frac{H^*(u,v)}{|H(u,v)|^2+S_\eta(u,v)/S_f(u,v)}]G(u,v)\\
=[\frac{1}{H(u,v)}\frac{|H(u,v)|^2}{|H(u,v)|^2+S_\eta(u,v)/S_f(u,v)}]G(u,v)
$$
​		维纳滤波
​		方括号内的项组成的滤波器称为最小均方误差滤波器或最小二乘误差滤波器

​		不存在退化函数为0的问题，除非对于相同的u和v
​		S_eta噪声的功率谱N（噪声的自相关）
​		S_f未退化图像的功率谱F

​		如果噪声为0，噪声功率消失，简化为逆滤波

​		**信噪比**
$$
SNR=\frac{\sum_{u=0}^{M-1}\sum_{v=0}^{N-1}|F(u,v)|^2}{\sum_{u=0}^{M-1}\sum_{v=0}^{N-1}|N(u,v)|^2}
$$
​		均方误差
$$
MSE=\frac{1}{MN}\sum_{x=0}^{M-1}\sum_{y=0}^{N-1}[f(x,y)-\hat{f}(x,y)]^2
$$
​		均方根信噪比或均方根误差
​		（把复原图像考虑为信号，把复原图像和原图像的差考虑为噪声）
$$
SNR=\frac{\sum_{x=0}^{M-1}\sum_{y=0}^{N-1}\hat{f}(x,y)^2}{\sum_{x=0}^{M-1}\sum_{y=0}^{N-1}[f(x,y)-\hat{f}(x,y)]^2}
$$
​		白噪声时，谱|N|^2为常数
​		当未退化图像功率谱等未知或不能估计
$$
\hat{F}(u,v)=[\frac{1}{H(u,v)}\frac{|H(u,v)|^2}{|H(u,v)|^2+K}]G(u,v)
$$
​		逆滤波和维纳滤波的比较
​		？半径受限的逆滤波

​		维纳滤波的进一步比较
​		噪声“窗帘”：去模糊图像中可以看到图像内容

#### 5.9 约束最小二乘方滤波

​		**g=Hf+eta**
​		其中g有MN×1维，H有MN×MN维
​		H对噪声高度敏感，解决的一种办法是以平滑度量的最佳复原为基础
​		最小准则函数
$$
C=\sum_{x=0}^{M-1}\sum_{y=0}^{N-1}[\nabla^2f(x,y)]^2
$$
​		约束为
$$
\lVert \boldsymbol{g}-\boldsymbol{H}\hat{\boldsymbol{f}}\rVert^2=\lVert\boldsymbol{\eta}\rVert^2
$$
​		平方为欧几里得向量范数
​		这个最佳化问题在频率域中的解决：
$$
\hat{F}(u,v)=[\frac{H^*(u,v)}{|H(u,v)|^2+\gamma|P(u,v)|^2}]G(u,v)
$$

$$
p(x,y)=\begin{bmatrix} 0 & -1 & 0 \\ -1 & 4 & -1 \\ 0 & -1 & 0 \\ \end{bmatrix}
$$

​		P为p的傅里叶变换
​		gamma为0时简化为逆滤波

​		维纳滤波和最小二乘方滤波的比较
​		约束最小二乘方滤波对于高噪声和中等噪声的情况效果好一些，对于低噪声，两种滤波产生基本相等的结果
​		步骤：
​		1）指定γ的初始值
​		2）计算||r||^2
​		3）根据||r||^2递增的性质，通过增大减小γ，迭代计算最终的γ，带入计算最佳估计F
​		牛顿-拉弗森算法
​		R=G-HF^
​		||r|| ^ 2=ΣΣr ^ 2

​		对于||η||^2
$$
\lVert \eta \rVert ^2 = MN[\sigma_\eta^2+m_\eta^2]
$$
​		最佳约束最小二乘方滤波的迭代估计
​		通常，自动确定的复原滤波器比人为调整滤波器参数的复原结果要差。特别是约束最小二乘方滤波器完全由单一的标量参数来决定时更是如此

#### 5.10 几何均值滤波

​		对维纳滤波器的推广，几何均值滤波器
$$
\hat{F}(u,v)
=[\frac{H^*(u,v)}{|H(u,v)|^2}]^\alpha[\frac{H^*(u,v)}{|H(u,v)|^2+\beta[\frac{S_\eta(u,v)}{S_f(u,v)}]}]^{1-\alpha}G(u,v)
$$
​		alpha为1，逆滤波器
​		alpha为0，参数维纳滤波器，beta为1标准的维纳滤波器
​		alpha为1/2，beta为1，谱均衡滤波器

#### 5.11 由投影重建图像

​		X射线计算机断层（CT）
​		注：计算机轴向断层术CAT

​		**引言**
​		射线和
​		反投影法
​		“晕环”现象
​		相隔180度的投影互为镜像图像，因此，为了产生重建所要求的所有投影，我们只要按圆周的一半角度增量来考虑就可以

​		包含两个物体的简单平面的反投影

​		**计算机断层（CT）原理**
​		雷登变换：一种沿着平行射线对一个二维物体投影的方法
​		四代CT扫描仪：G1（直）、G2（小扇形）、G3（大扇形）、G4（圆环检测器）
​		G5：电子束计算机断层（EBCT）扫描器
​		G6：螺旋CT（病人也转）
​		G7：多切片CT扫描仪（厚的扇形射线）

​		**投影和雷登变换**
​		SPECT（单电子发射断层）、PET（正电子发射断层）、MRI（核磁共振成像）、超声成像
​		雷登变换：
$$
g(\rho,\theta)=\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(x,y)\delta(x cos\theta+y sin\theta-\rho)dxdy
$$
​		沿xy平面内任意一条线的f的投影（线积分）的公式
​		也可以用${\mathcal{R}\{f(x,y)\}}$或${\mathcal{R\{f\}}}$
​		离散情况下：
$$
g(\rho,\theta)=\sum_{x=0}^{M-1}\sum_{y=0}^{N-1}f(x,y)\delta(x cos\theta+y sin\theta-\rho)
$$
​		使用雷登变换得到圆形区域的投影

​		正弦图、Shepp-Logan幻影

​		反投影，theta固定：
$$
f_{\theta_k}(x,y)=g(\rho,\theta_k)=g(xcos\theta_k+ysin\theta_k,\theta_k)
$$
​		最后对所有反投影图像积分：
$$
f_\theta(x,y)=g(xcos\theta+ysin\theta,\theta)\\
f(x,y)=\int_0^\pi f_\theta(x,y)d\theta
$$
​		离散时：
$$
f(x,y)=\sum_{\theta=0}^\pi f_\theta(x,y)
$$
​		形成的反投影图像有时称为层图，可以隐含地理解为仅对产生投影的图像的一个近似

​		从正弦图得到反投影图像

​		**傅里叶切片定理**
​		关于rho投影的一维傅里叶变换：
$$
G(\omega,\theta)=\int_{-\infty}^\infty g(\rho,\theta)e^{-j2\pi\omega\rho}d\rho
$$
​		带入g，利用冲激特性化简，再变换得到：
$$
G(\omega,\theta)=\int_{-\infty}^\infty\int_{-\infty}^\infty f(x,y)e^{-j2\pi\omega(xcos\theta+ysin\theta)}dxdy\\
=[\int_{-\infty}^\infty\int_{-\infty}^\infty f(x,y)e^{-j2\pi(ux+vy)}dxdy]_{u=\omega cos\theta;v=\omega sin\theta}
$$
​		与指定uv的f的二维傅里叶变换等价

​		一个投影的傅里叶变换是得到投影区域的二维傅里叶变换的一个切片

​		**使用平行射线束滤波反投影的重建**
​		**（有点难）**
$$
f(x,y)=\int_0^\pi[\int_{-\infty}^\infty|\omega|G(\omega,\theta)e^{j2\pi\omega\rho}d\omega]_{\rho=xcos\theta+ysin\theta}d\theta
$$
​		方括号内是一维傅里叶反变换形式，附加绝对值项，可认为是一维滤波函数，斜坡滤波器Ram-Lak
​		为了避免加窗出现的振铃，使用汉明窗
$$
h(\omega)=\begin{cases}
c+(c-1)cos\frac{2\pi\omega}{M-1},&0\leq\omega\leq(M-1)\\
0,&其他
\end{cases}
$$
​		c为0.5时，韩窗
​		加窗斜坡振铃现象减少，但是稍微多一些模糊

​		1）计算每一个投影的一维傅里叶变换
​		2）用滤波函数乘每一个傅里叶变换，就是乘一个合适的窗
​		3）得到每一个滤波后的变换的一维反傅里叶变换
​		4）所有一维反变换积分（求和）

​		滤波反投影

​		取样考虑射线数量、旋转角度增量的数量

​		使用滤波反投影的图像重建

​		同理也是可以使用卷积定理，表示为空间上的卷积

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\滤波反投影傅里叶.PNG)

​		迫零问题

​		**使用扇形射线束滤波反投影的重建**
​		

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\扇形.PNG" style="zoom:60%;" />

​		${\theta=\beta+\alpha}$且${\rho=Dsin\alpha}$
​		基于滤波反投影的基本扇形重建公式
$$
f(r,\phi)=\frac{1}{2}\int_0^{2\pi}\int_{-\alpha_m}^{\alpha_m}p(\alpha,\beta)s[rcos(\beta+\alpha-\phi)-Dsin\alpha]Dcos\alpha d\alpha d\beta
$$
​		

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\滤波反投影扇形.PNG)

​		**这里公式很多很复杂，头疼**

​		第m个射线投影中的第n条射线等于第（m+n）个平行投影中的第n条射线

​		使用滤波扇形反投影的图像重建
​		


## 第6章 彩色图像处理

#### 引言

​		彩色图像处理可分为两个主要领域：全彩色处理和伪彩色处理
​		前者通常要求图像用全彩色传感器获取
​		后者问题是对一种特定的单色灰度或灰度范围

















































## * 第7章 小波和多分辨率处理



## * 第8章 图像压缩



## 第9章 形态学图像处理（1-3）







## 第10章 图像分割（1-3）







## * 第11章 表示和描述



## * 第12章 目标识别