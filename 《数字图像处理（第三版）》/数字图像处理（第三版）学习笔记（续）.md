# 《数字图像处理》学习笔记



前5章做了2w+字的笔记，还有很多公式，导致打开后很卡，所以后面几章将建立新的笔记

## 第6章 彩色图像处理

#### 引言

​		彩色图像处理可分为两个主要领域：全彩色处理和伪彩色处理
​		前者通常要求图像用全彩色传感器获取
​		后者问题是对一种特定的单色灰度或灰度范围赋予一种颜色

#### 6.1 彩色基础

​		灰度级仅提供了亮度的标量度量

​		彩色光源质量的3个基本量：辐射（总量，瓦特）、光强（观察者感知，流明）和亮度（主观描绘子）

​		CIE（国际照明委员会）三原色：蓝435.8nm、绿546.1nm、红700nm
​		CRT阴极射线管
​		LCD液晶显示器
​		TFT薄膜晶体管
​		色调表示观察者感知的主要颜色。饱和度是相对的纯净度，或一种颜色混合白光的数量。纯谱色是全饱和的，饱和度与所加白光的数量成反比，越白就欠

​		色调与饱和度合称色度，颜色可用亮度和色度表征。形成任何特殊彩色的红、绿、蓝的数量称为三色值，XYZ
​		x=X/(X+Y+Z)等
​		确定颜色的另一种方法是CIE色度图，x，y，z=1-(x+y)
​		边界为纯色，内部混合色

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\CIE色度.PNG)

​		

#### 6.2 彩色模型

​		彩色模型（或彩色空间、彩色系统）
​		RBG（红绿蓝，彩色监视器和彩色视频摄像机）
​		CMY（青粉黄，打印机）
​		CMYK（青粉黄黑，打印机）
​		HSI（色调，饱和度，亮度，描述和解释）

​		**RGB彩色模型**
​		笛卡尔坐标系，RGB，青、深红、黄，黑白
​		灰度沿着黑白线
​		像素深度：每个像素的比特数
​		红绿蓝都是8比特，则每个RGB彩色像素有24比特
​		全彩色图像：24比特的RGB彩色图像
​		${(2^8)^3=16777216}$

​		生成RGB彩色立方体的隐藏面和剖面

​		稳定RGB色集合（或全系统稳定色集合）
​		Web色或稳定浏览器色

​		216种稳定色（0、51、102、153、204、255）
​		00、33、66、99、CC、FF
​		${6^3=216}$

​		部分灰色在稳定色的外面

​		**CMY和CMYK彩色模型**
​		青色、深红色、黄色（光的二次色、颜料的原色）
$$
\begin{bmatrix} C \\ M \\ Y \\ \end{bmatrix}=
\begin{bmatrix} 1 \\ 1 \\ 1 \\ \end{bmatrix}-
\begin{bmatrix} R \\ G \\ B \\ \end{bmatrix}
$$
​		（在这里已经归一化到0到1）
​		主要用于产生硬拷贝输出
​		因为产生黑色不纯，所以增加了黑色，CMYK，“四色打印”

​		**HSI彩色模型**
​		色调、饱和度和亮度（体现无色的强度概念）
​		RGB彩色立方体中，连接黑白两个顶点的线（灰度轴），强度（灰度级），垂直于强度轴并且包含该彩色点的平面确定彩色点的强度分量
​		一种颜色的饱和度（纯度）以强度轴的距离为函数而增大，强度轴上饱和度为0

​		连接黑白和边界点，形成相同色调的平面（黑白不改变色调），旋转，形成HSI

​		**从RGB到HSI的彩色转换**
$$
H=\begin{cases}
\theta,&B\leq G\\
360-\theta,&B>G
\end{cases}
$$

$$
\theta=arc\ cos\{\frac{\frac{1}{2}[(R-G)+(R-B)]}{[(R-G)^2+(R-B)(G-B)]^{1/2}}\}
$$

$$
S=1-\frac{3}{(R+G+B)}[min(R,G,B)]
$$

$$
I=\frac{1}{3}(R+G+B)
$$

​		**从HSI到RGB的彩色转换**

​		RG扇区（H为0到120度）
$$
B=I(1-S)
$$

$$
R=I[1+\frac{S\ cosH}{cos(60^\circ-H)}]
$$

$$
G=3I-(R+B)
$$

​		GB扇区（H为120到240度）
$$
H=H-120^{\circ}
$$

$$
R=I(1-S)
$$

$$
G=I[1+\frac{S\ cosH}{cos(60^\circ-H)}]
$$

$$
B=3I-(R+B)
$$

​		BR扇区（H为240到360度）
$$
H=H-240^{\circ}
$$

$$
G=I(1-S)
$$

$$
B=I[1+\frac{S\ cosH}{cos(60^\circ-H)}]
$$

$$
R=3I-(R+B)
$$

​		对应于RGB彩色立方体图像的HSI值

​		**处理HSI分量图像**

#### 6.3 伪彩色图像处理

​		伪彩色（或假彩色）图像处理是指基于一种特定的规则对灰度值赋以颜色的处理
​		**灰度分层**
​		或者称为密度分层（灰度分割），和彩色编码技术是伪彩色图像处理的最简单的例子之一
​		0到L-1表示灰度级，l_0表示黑色，l_{L-1}表示被色
​		灰度级到彩色幅值：
$$
f(x,y)=c_k \\
f(x,y)\in V_k
$$
​		V表示P个平面分成的P+1个区间

​		灰度分层

​		使用彩色突出降雨量

​		**灰度到彩色的变换**
​		对任何输入像素的灰度执行3个独立的变换，而不是位置函数
​		f_R(x,y)，f_G(x,y)，f_B(x,y)

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\伪彩色1.PNG" style="zoom:60%;" />

​		突出行李内包含的爆炸物的伪彩色应用
​		改变正弦波的相位和频率

​		另外，多幅单色图像组合成一幅彩色合成图像。彩色平衡、混合图像以及以产生图像的传感器响应特性

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\伪彩色2.PNG" style="zoom:60%;" />

​		多光谱图像的彩色编码
​		组合感知图像数据

#### 6.4 全彩色图像处理基础

​		两类处理方法：
​		第一类是分别处理每一幅分量图像，然后由分别处理过的分量图像来形成一幅处理过的合成彩色图像
​		第二类是直接处理彩色像素（向量）

​		为了使每种彩色分量处理和基于向量的处理等同，必须满足两个条件：
​		第一，处理必须对向量和标量都可用
​		第二，对向量的每一分量的操作对于其他分量必须是独立的

#### 6.5 彩色变换

​		主要涉及在单一彩色模型内处理彩色图像的分量么不是这些分量在不同模型间的转换

​		**公式**
$$
g(x,y)=T[f(x,y)]
$$

$$
s_i=T_i(r_1,r_2,...,r_n),\ i=1,2,...,n
$$

​		合并为T单一变换函数

​		**补色**
​		彩色环
​		补色类似灰度负值
​		补色对于增强嵌在彩色图像暗区的细节很有用——特别是区域在大小上占优势时

​		计算彩色图像的补色

<img src="F:\学习笔记（敲字人）\数字图像处理的一些图片\补色.PNG" style="zoom:60%;" />

​		**彩色分层**
​		显示感兴趣的颜色以便从背景中突出它们
​		像模板那样使用由彩色定义的区域，以便进一步处理
$$
s_i=\begin{cases}
0.5,&[|r_j-a_j|>\frac{W}{2}]_{1\leq j\leq n}\ i=1,2,...,n\\
r_i,&其他
\end{cases}
$$
​		把某些感兴趣区域之外的彩色映射为不突出的无确定性质的颜色。宽为W，中心在原型（平均）颜色点并且具有分量a_i的立方体或超立方体

​		圆球体：
$$
s_i=\begin{cases}
0.5,&\sum_{j=1}^n(r_j-a_j)^2>R_0^2\ i=1,2,...,n\\
r_i,&其他
\end{cases}
$$
​		减少颜色的亮度

​		彩色分层的说明

​		**色调和彩色校正**
​		高级彩色重现不需要配备传统的湿式处理（暗室）设备

​		照片增强和颜色再现
​		监视器和最终输出设备间保持色彩的高度一致性是必要的，最好用独立于设备彩色模型来实现，这种彩色模型与监视器、输出设备及所用的任何其他设备的色域有关
​		许多颜色处理系统（CMS）选择的模型是CIE L  * a * b * 模型，也称为CIELAB
$$
L^*=116·h(\frac{Y}{Y_W})-16\\
a^*=500[h(\frac{X}{X_W})-h(\frac{Y}{Y_W})]\\
b^*=200[h(\frac{Y}{Y_W})-h(\frac{Z}{Z_W})]\\
h(q)=\begin{cases}
\sqrt[3]{q},&q>0.008856\\
7.787q+16/116,&q\leq0.008856
\end{cases}
$$
​		XYZ参考白色三激励值，CIE标准D65照度下完美的漫反射白色，x=0.3127和y=0.3290
​		L * a * b * 彩色空间是比色的（与感觉色相匹配的编码相同）、感觉一致的（各种色调中颜色差别感觉上一致）、独立于设备的
​		亮度，彩色（红减绿，绿减蓝）
​		在图像操作（色调和对比度编辑）和图像压缩方面很有用

​		标定成像系统的主要意义是，允许交互和独立地校正色调和色彩的不平衡
​		色调范围（主调范围）指颜色强度的基本分布
​		高主调图像多数信息集中在高（亮）强度处
​		低主调图像则低亮度处
​		中主调两者之间

​		CIELUV、YIQ、YUV、YCC、XYZ

​		色调变换

​		彩色平衡
​		基于彩色环，任何颜色的比例都可以通过减少图像中相对色（或补色）数量来增大。类似地，提高两种直接邻接颜色的比例或减少与该补色邻接的两种颜色的百分比也可增大颜色的对比
​		（过多的深红色和太少的青色会导致太多的红色）

​		**直方图处理**
​		单独对彩色分量进行直方图均衡通常是不明智的，这将产生不正确的彩色
​		而应该均匀地展开这种彩色灰度，而保持彩色本身（即色调）不变
​		HSI彩色空间是适合这种方法的理想空间

​		HSI彩色空间中的直方图均衡
​		有时候会需要增加图像饱和度分量部分等来校正结果

#### 6.6 平滑和锐化

​		**彩色图像平滑**
​		灰度级图像平滑可用看成是一种空间滤波操作

​		S_xy表示中心位于(x,y)的邻域定义的一组坐标，在该邻域中RGB分量的向量平均值为
$$
\bar{c}(x,y)=\frac{1}{K}\sum_{(s,t)\in S_{xy}}c(s,t)
$$
​		遵循向量相加的性质，可以对RGB每个分量计算
​		邻域平均平滑可以在每个彩色平面的基础上执行，结果与使用RGB彩色向量执行平均是相同的

​		用邻域平均法平滑彩色图像

​		**彩色图像锐化**
​		拉普拉斯方法进行图像（尖）锐化处理
$$
\nabla^2[c(x,y)]=\begin{bmatrix} \nabla^2[R(x,y)] \\ \nabla^2[G(x,y)] \\ \nabla^2[B(x,y)] \\ \end{bmatrix}
$$
​		使用拉普拉斯的锐化

#### 6.7 基于彩色的图像分割

​		**HSI彩色空间的分割**
​		在色调图像中描绘彩色很方便
​		为了在色调图像中分离出感兴趣的孤立区域，将饱和度用做一幅模板图像
​		在彩色图像分割中不常使用亮度图像，因为它不携带彩色信息

​		HSI空间中的分割

​		**RGB向量空间中的分割**
​		用RGB彩色向量结果更好
​		给定一个感兴趣的有代表性彩色的彩色样点集，可得到完美希望分割颜色的平均估计
​		这个平均估计用RGB向量a表示
​		z为RGB空间中的任意一点
​		用欧式距离比较，如果它们之间的距离小于特定的阈值D_0则称z与a相似
$$
D(z,a)=\lVert z-a\rVert\\
=[(z-a)^T(z-a)]^{\frac{1}{2}}\\
=[(z_R-a_R)^2+(z_G-a_G)^2+(z_B-a_B)^2]^{\frac{1}{2}}
$$
​		还有一种推广
$$
D(z,a)=[(z-a)^TC^{-1}(z-a)]^{\frac{1}{2}}
$$
​		C为我们希望分割的有代表性颜色的样本的协方差矩阵
​		由球体变成椭球体（主轴面向最大数据扩展方向）

​		计算代价太高？使用边界盒
​		盒的中心在a处，沿每一个颜色轴选择的维数与沿每个轴的样本的标准差成比例
​		标准差的计算只使用一次样本颜色数据

​		RGB空间中的彩色图像分割

​		**彩色边缘检测**
​		梯度算子边缘检测，但是计算单幅图像的梯度然后用得到的结果形成一幅彩色图像将会导致错误的结果
​		处理三个单独的平面所形成的合成梯度图像可导致错误的结果，所以需要适合向量的梯度的新定义：

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\向量梯度.PNG)

​		向量空间中的边缘检测

#### 6.8 彩色图像中的噪声

​		噪声对不同的彩色通道所造成的影响不同，一种可能是个别通道的电子学故障
​		不同的噪声水平像是由每个彩色通道的相对照射强度的差异造成的
​		（例如CCD摄像机中红色滤镜的使用减少用于红色传感器的照射强度。CCD传感器在低照明水平下就是噪声源）

​		将RGB带噪图像转换为HSI的效果说明

#### 6.9 彩色图像压缩

​		彩色图像压缩实例
​		JPEG2000

## * 第7章 小波和多分辨率处理



## * 第8章 图像压缩



## 第9章 形态学图像处理（1-3）

#### 引言

​		形态学morphology
​		数学形态学，将数学形态学作为工具从图像中提取表达和描绘区域形状的有用图像分量，如边界、骨架和凸壳等
​		预处理或后处理的形态学技术，如形态学过滤、细化和修建
​		n维欧式空间

#### 9.1 预备知识

​		数学形态学的语言是集合论
​		集合的反射和平移
​		（集合反射操作类似于空间卷积中执行的翻转或旋转操作）
​		反射：
$$
\hat{B}=\{w|w=-b,\ b\in B\}
$$
​		（如果描述的是二维点，则表示对称的点）
​		前景（物体）和背景（非物体）

​		平移：
$$
(B)_z=\{c|c=b+z,\ b\in B \}
$$
​		（x+z_1, y+z_2）

​		结构元（SE）操作：研究一幅图像中感兴趣特性所用的小集合或子图像
​		指定元素是SE的成员，指定结构元的原点

​		当对图像操作时，我们要求结构元是矩形阵列（通过添加最小可能数量的背景元素形成一个矩形阵列来实现的）

​		定义一个用结构元B在集合A上的操作如下：
​		通过让B在A上运行，以便B的原点访问A的每一个元素，来创建一个新集合。

#### 9.2 腐蚀和膨胀

​		**腐蚀**
​		${Z^2}$中的集合A和B，B对A的腐蚀定义为：
$$
A\ominus B=\{z|(B)_z\subseteq A\}
$$
​		用z平移的B包含在A中所有的点z的集合
​		等价于
$$
A\ominus B=\{z|(B)_z\cap A^c=\emptyset \}
$$
​		使用腐蚀去除图像的某些部分
​		腐蚀缩小或细化了二值图像中的物体，我们可以将腐蚀看成是形态学滤波操作，这种操作将小于结构元的图像细节从图像中滤除（去除）了

​		“线滤波”

​		**膨胀**
​		${Z^2}$中的集合A和B，B对A的膨胀定义为：
$$
A\oplus B=\{z|(\hat{B})_z\cap A\neq \emptyset\}
$$
​		以B关于它的原点的映像，并且以z对映像进行平移为基础
​		等价于
$$
A\oplus B=\{z|[(\hat{B})_z\cap A]\sube A \}
$$
​		相当于是B关于其原点旋转，然后逐步移动以滑过整个集合（图像），类似空间卷积。但是非线性操作（因为是集合），而卷积是线性操作

​		腐蚀是收缩或细化操作，膨胀则会“增长”或“粗化”二值图像中的物体。特殊的方式和粗化的宽度由所用的结构元来控制

​		膨胀的说明
​		膨胀的最简应用之一就是桥接裂缝
​		形态学方法较之用于桥接断裂的低通滤波方法的一个直接的优点，就是形态学方法可在一幅二值图像中直接得到结果
​		另一方面低通滤波方法则从一幅二值图像开始生成一幅灰度图像，它需要一个阈值函数将灰度图像转换为二值图像

​		**对偶性**
​		膨胀和腐蚀彼此关于集合求补运算和反射运算是对偶的，即
$$
(A\ominus B)^c=A^c\oplus \hat{B}\\
(A\oplus B)^c=A^c\ominus \hat{B}
$$
​		B对A的腐蚀是${\hat{B}}$对${A^c}$的膨胀的补，反之亦然
​		特别是结构元对称时特别有用

#### 9.3 开操作和闭操作

​		开操作一般会平滑物体的轮廓、断开较窄的狭颈并消除细的突出物
​		闭操作同样也会平滑轮廓的一部分，但是通常会弥合较窄的间断和细长的沟壑，消除小的孔洞，填补轮廓线中的断裂

​		结构元B对集合A的开操作（腐蚀再膨胀）
$$
A\circ B=(A\ominus B)\oplus B
$$
​		结构元B对集合A的闭操作（膨胀再腐蚀）
$$
A\cdot B=(A\oplus B)\ominus B
$$
​		开操作可以理解为转球B在A的边界内侧滚动，最终边界由B中的点建立
$$
A\circ B=\bigcup\{(B)_z|(B)_z\sube A\}
$$
​		闭操作则相当于外侧滚动（新书中这么说：B不进入A的任何部分的前提下，B可以到达的最远的点）

​		形态学开操作和闭操作的简单说明
​		开操作：方向向外的角（就是凸角啦）变圆了，而方向向内的角则未受影响
​		闭操作：方向向内的角变圆了，而方向向外的角则保持不变

​		开操作断开小连接，闭操作补上小断裂

​		对偶性：
$$
(A\cdot B)^c=(A^c\circ \hat{B})\\
and\\
(A\circ B)^c=(A^c\cdot \hat{B})
$$
​		开操作性质：
​		a）${A\circ B}$是A的一个子集
​		b）如果C是D的子集，则${C\circ B}$是${D\circ B}$的一个子集
​		c）${(A\circ B)\circ B=A\circ B}$

​		闭操作性质：
​		a）A是${A\cdot B}$的一个子集
​		b）如果C是D的子集，则${C\cdot B}$是${D\cdot B}$的一个子集
​		c）${(A\cdot B)\cdot B=A\cdot B}$

​		针对形态学滤波使用开操作和闭操作
​		腐蚀再膨胀，消掉小白点
​		膨胀再腐蚀，消掉小黑点
​		

### 本章后续部分暂无要求，不看




## 第10章 图像分割（1-3）

#### 引言

​		异常图像的分割是图像处理中最困难的任务之一
​		多数分割算法均基于灰度值的两个基本性质之一：不连续性和相似性
​		在第一类中，方法是以灰度突变为基础分割一幅图像
​		在第二类中，主要方法是根据一组预定义的准则将一幅图像分割为相似的区域（阈值处理、区域生长、区域分裂和区域聚合）

#### 10.1 基础知识

​		R**分割**为n个子区域，并集为R，每个都是连通集（4连接或8连接），互不相交，Q(R_i)=TRUE，Q(R_i并R_j)=FALSE
​		Q表示一个关于集合中的点的逻辑属性，可以是一个复合表达式，例如平均灰度小于什么什么，标准差大于什么什么
​		（哎呀就是说，分割后的区域，区域内部一定具有相同的属性，而区域之间不同）

​		不连续性：边界彼此完全不同，且与背景不同，从而允许基于灰度的局部不连续性来进行边界检测（例如基于边缘的分割）
​		相似性：基于区域的分割方法，事先定义的一组准则把一幅图像分割成相似的几个区域		

#### 10.2 点、线和边缘检测

​		孤立点、线和边缘
​		边缘像素是图像中灰度突变的那些像素，而边缘（或边缘线段）是连接的边缘像素的集合
​		边缘检测器是设计用来检测边缘像素的局部图像处理方法
​		”屋顶边缘“

​		**背景知识**
​		用导数、差分
​		一阶导数要求：
​		1）在恒定灰度区域必须为0
​		2）灰度台阶或斜坡开始处必须不为0
​		3）沿灰度斜坡点处也必须不为0

​		二阶导数要求：
​		1）在恒等灰度区域必须为0
​		2）灰度台阶或斜坡的开始和结束处必须不为0
​		3）沿灰度斜坡必须为0		

​		Δx=1

​		屋顶边缘

​		一阶导数产生“粗”边缘，二阶导数产生细边缘
​		在增强剧烈变化方面，二阶导数比一阶导数更为激进，在增强细节（包括噪声）方面二阶导数远强于一阶导数
​		1）一阶导数通常在图像中产生较粗的边缘
​		2）二阶导数对精细细节，如细线、孤立点和噪声有较强的响应
​		3）二阶导数在灰度斜坡和灰度台阶过渡处会产生双边缘响应
​		4）二阶导数的符号可用于确定边缘的过渡是从亮到暗还是从暗到亮

​		使用空间滤波器来计算

​		**孤立点的检测**
​		拉普拉斯变换

​		图像中孤立点的检测

​		**线检测**
​		也可以使用拉普拉斯模板，但是需要注意二阶导数的双线效应必须做适当的处理

​		用拉普拉斯进行线检测
​		正负两线，更加合适的办法是仅使用正值

​		检测特定方向的线，使用不同模板

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\线检测模板.PNG)

​		特定方向线的检测
​		“调谐”

​		**边缘模型**
​		边缘检测是基于灰度突变来分割图像的最常用的方法
​		边缘模型根据它们的灰度剖面来分类：台阶模型、斜坡模型和屋顶边缘模型

​		台阶边缘是指在1个像素的距离上发生两个灰度级间理想的过渡
​		（坎尼边缘检测算法后面会提到）

​		数字图像都存在被模糊且带有噪声的边缘，模糊的程度主要取决于聚焦机理（如光学成像中的镜头）中的限制，而噪声水平主要取决于成像系统的电子元件。
​		这种情况，边缘被建模为更加接近灰度斜坡的剖面
​		斜坡的斜度与边缘的模糊程度成反比

​		“屋顶”边缘，通过一个区域的线的模型，基底（宽度）由该线的宽度和尖锐度决定

​		零灰度轴和二阶导数极值点间的连线的交点称为该二阶导数的零交叉点

​		结论：
​		一阶导数的幅度可用于检测图像中的某个点处是否存在一个边缘。二阶导数的符号可用于确定一个边缘像素位于该边缘的暗的一侧还是亮的一侧。

​		1）对图像的每条边缘，二阶导数生成两个值（一条不希望的特点）
​		2）二阶导数的零交叉点可用于定位粗边缘的中心

​		一条有噪声边缘的一阶导数和二阶导数的性质
​		微弱的可见噪声对检测边缘所用的两个关键导数有严重影响

​		执行边缘检测的3个基本步骤：
​		1）为降噪对图像进行平滑处理
​		2）边缘点的检测（找到候选边缘点）
​		3）边缘定位（选择组成边缘点集合中的真实成员）

​		**基本边缘检测**
​		**图像梯度及其性质**
​		${\nabla f}$
​		向量，指出f在(x,y)处的最大变化率的方向
​		向量的大小为M，梯度向量方向变化率的值，M形成的图像叫做梯度图像，或在含义很清楚时简称为梯度
​		梯度向量的方向α
​		求和、平方和开方都是阵列操作
​		任意点处一个边缘的方向与该点处梯度向量的方向α正交

​		梯度的性质
​		梯度向量有时也称为边缘法线
​		向量通过除以其幅值而归一化为单位长度时，结果向量通常称为边缘单位法线

​		**梯度算子**
​		用于计算梯度偏导数的滤波器模板，通常称为梯度算子、差分算子、边缘算子或边缘检测子
​		罗伯特交叉梯度算子用于计算对角线方向的边缘
​		Prewitt算子
​		Sobel算子

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\梯度模板.PNG)

​		Sobel模板能较好地抑制（平滑）噪声的特性
​		（图中左侧计算出来是g_x，右侧是g_y，x轴向下，y轴向右）

​		使用绝对值来近似梯度幅值：M约等于g_x绝对值加g_y绝对值
​		计算上更加有吸引力，而且保持着灰度级的相对变化，但是导致滤波器一般将不再是各向同性（旋转不变）的
​		使用Prewitt和Sobel，并不是问题，因为只有边缘才各向同性

​		检测对角线方向边缘的Prewitt和Sobel模板：

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\检测对角线边缘的模板.PNG)

​		二维梯度幅值和角度的说明
​		通常对于边缘检测而言，角度图像不像幅度图像那样有用，但它们可以作为用梯度幅值从图像中提取的信息的补充
​		平滑后图像的最大边缘强度（幅度）会随着平滑模板尺寸的增加而减小

​		**与阈值处理相结合的梯度**
​		在计算梯度前对图像进行平滑处理，边缘检测可做更多的选择。实现相同的基本目标的另一种方法是对梯度图像进行阈值处理
​		阈值处理后的图像中边缘更少，并且图像中的边缘要尖锐得多。另外在阈值处理后的图像中，许多边缘被断开了
​		当目的是突出主要边缘并尽可能维护连续性时，实践中通常平滑处理和阈值处理两者都使用

​		**更先进的边缘检测技术**
​		**Marr-Hildreth边缘检测器**
​		1）灰度变化与图像尺寸无关，因此检测要求使用不同尺寸的算子
​		2）灰度的突然变化会在一阶导数中引起波峰或波谷，或在二阶导数中等效地引起零交叉

​		所以用于边缘检测的算子应有两个显著的特点：
​		第一个和最重要的特点是一个能计算图像中的每一点处的一阶导数或二阶导数的数字近似的微分算子
​		第二是它应能被“调整”以便在任何期望的尺寸上起作用
​		（大的算子也可用于检测模糊边缘，小的算子可用于检测锐度集中的精细细节）
​		满足这些条件的最令人满意的算子是滤波器${\nabla^2G}$，其中${\nabla^2}$是拉普拉斯算子，G是标准差σ（空间常数）的二维高斯函数：
$$
G(x,y)=e^{-\frac{x^2+y^2}{2\sigma^2}}
$$
​		最终得到：高斯拉普拉斯LoG
$$
\nabla^2G(x,y)=[\frac{x^2+y^2-2\sigma^2}{\sigma^4}]e^{-\frac{x^2+y^2}{2\sigma^2}}
$$
​		（LoG函数有时也称为墨西哥草帽算子）

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\LoG.PNG)

​		生成LoG滤波器的一种更有效的方法是以希望的n×n尺寸对上式进行取样，然后将结果阵列与一个拉普拉斯模板进行卷积
​		1）算子的高斯部分会模糊图像，从而在尺寸上将结构的灰度（包括噪声）降低到远小于σ的程度
​		2）滤波器的二阶导数部分。拉普拉斯有各向同性，符合人的视觉系统特性，而且对任何模板方向的灰度变化有相等的响应，从而避免了使用多个模板去计算图像中任何点处的最强响应
$$
g(x,y)=[\nabla^2G(x,y)]★f(x,y)\\
g(x,y)=\nabla^2[G(x,y)★f(x,y)]
$$
​		寻找g的零交叉来确定f中边缘的位置

​		1）用一个对高斯取样得到的n×n高斯低通滤波器对输入图像滤波
​		2）计算由第一步得到的图像的拉普拉斯
​		3）找到所得图像的零交叉

​		n应该是大于等于6σ的最小正奇数
​		找零交叉，一种方法是用以p为中心的一个3×3邻域，零交叉意味着至少两个相对的邻域像素的符号不同
​		邻交叉像素
​		亚像素精度

​		Marr-Hildreth边缘检测算法说明
​		意大利通心粉效应：边缘形成了闭环

​		使用高斯差分DoG来近似LoG滤波器是可能的
$$
DoG(x,y)=\frac{1}{2\pi\sigma_1^2}e^{-\frac{x^2+y^2}{2\sigma_1^2}}-\frac{1}{2\pi\sigma_2^2}e^{-\frac{x^2+y^2}{2\sigma_2^2}}\\
其中\\
\sigma_1>\sigma_2
$$
​		使用1.75:1的标准差的比率来建模，1.6:1不仅可保持这些观察的基本特性，而且还可对LoG函数提供一个更接近的“工程”近似

​		LoG的σ的选择：
$$
\sigma^2=\frac{\sigma_1^2\sigma_2^2}{\sigma_1^2-\sigma_2^2}ln[\frac{\sigma_1^2}{\sigma_2^2}]
$$
​		使得LoG和DoG零交叉相同，尽管幅度大小会不同

​		LoG和DoG的滤波操作可直接使用一维卷积代替二维卷积来实现

​		**坎尼边缘滤波器（有点难理解）**
​		Canny是迄今为止讨论过的边缘检测器中最为优秀的
​		1）低错误率。所以边缘都应被找到，并且应该没有伪响应。检测到的边缘必须尽可能是真实的边缘
​		2）边缘点应被很好地定位。已定位边缘必须尽可能接近真实边缘。也就是由检测器标记为边缘的点和真实边缘的中心之间的距离应该最小
​		3）单一的边缘点响应。对于真实的边缘点，检测器仅应返回一个点。也就是真实边缘周围的局部最大数应该是最小的。这意味着在仅存一个单一边缘点的位置，检测器不应指出多个边缘像素

​		对由加性高斯白噪声污染的一维台阶边缘使用数字最佳化会得到这样一个结论，即对最佳台阶边缘检测器的一个较好近似是高斯一阶导数：
$$
\frac{d}{dx}e^{-\frac{x^2}{2\sigma^2}}=\frac{-x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}}
$$
​		推广到二维会涉及识别一维方法是否仍适用于边缘线的方向
​		首先使用一个环形二维高斯函数平滑图像，计算结果的梯度，然后使用梯度幅度和方向来估计每一点处的边缘强度和方向
​		G，G和f卷积，再求梯度，得到M和α

​		非最大抑制（？）
​		水平边缘22.5度
​		非最大抑制方案：
​		d_1，d_2，d_3，d_4表示四个基本边缘方向水平、负45、垂直、正45
​		1）寻找最接近α的方向d_k
​		2）如果M至少小于两个邻居之一，则g_N=0（抑制），否则为M，g_N为非最大抑制后的图像
​		最后对g_N进行阈值处理

​		阈值如果过低，存在伪边缘（伪正值）
​		阈值如果太高，删除实际上有效的边缘点（伪负值）
​		坎尼算法通过使用滞后阈值改进
​		低阈值T_L、高阈值T_H
​		坎尼建议高低比率为2:1或3:1
$$
g_{NH}(x,y)=g_N(x,y)\geq T_H\\
g_{NL}(x,y)=g_N(x,y)\geq T_L\\
g_{NL}(x,y)=g_{NL}(x,y)-g_{NH}(x,y)
$$
​		NH中的所有强像素均被假设为有效的边缘像素，并被立即标记。取决于H的值，NH中的边缘通常存在缝隙，较长的边缘用下列步骤形成：
​		a）g_NH中定位下一个未被访问的边缘像素p
​		b）g_NL中将所有的弱像素标记为有效边缘像素，用8连通的连接方法连接到p
​		c）如果g_NH中所有非零像素已被访问，跳到d，否则a
​		d）g_NL中未被标记为有效边缘像素的所有像素置零

​		最后将来自g_NL的所有非0像素附加到g_NH，形成最终图像

​		坎尼边缘检测算法步骤：
​		1）用高斯滤波器平滑输入图像
​		2）计算梯度幅值图像和角度图像
​		3）对梯度幅值图像应用非最大抑制
​		4）用双阈值处理和连接分析来检测并连接边缘

​		坎尼边缘检测方法说明

​		本节中讨论的三种主要边缘检测方法的另一说明
​		坎尼算法改进性能所付出的代价是比早些时候讨论的两种方法实现起来更复杂，同时执行时间会更长
​		某些应用，成本和速度要求使用更简单的技术，主要是阈值梯度方法。当关注边缘质量，通常使用Marr-Hilderth和坎尼，特别坎尼

​		**边缘连接和边界检测**
​		三种方法：
​		第一种需要有关局部区域中边缘点的知识
​		第二种要求区域边界上的点已知
​		第三种是处理整个边缘图像的全局方法

​		**局部处理**
​		连接边缘点最简单的方法之一是在每个点处的一个小邻域内分析像素的特点，将所有相似点连接起来，以形成根据指定准则满足相同特性像素的一条边缘

​		确定边缘像素相似性的两个主要性质是：
​		1）梯度向量的强度（幅度）
​		2）梯度向量的方向
$$
|M(s,t)-M(x,y)|\leq E\\
|\alpha(s,t)-\alpha(x,y)|\leq A
$$
​		E是正阈值、A是正角度阈值
​		1）计算输入图像f的梯度幅度阵列M和梯度角度阵列α
​		2）形成一幅二值图像g，任何坐标对(x,y)处的值：
$$
g(x,y)=\begin{cases}
1,&M(x,y)>T_M且\alpha(x,y)=A\pm T_A\\
0,&其他
\end{cases}
$$
​		3）扫描g的行，并在不超过指定长度K的每一行中填充（置1）所有缝隙（0的集合）。缝隙一定要限制在一个1或多个1的两端。分别处理各行，它们之间没有记忆
​		4）为在任何方向θ上检测缝隙，以该角度旋转g，应用3中水平扫描过程。然后将结果以-θ旋转回来

​		使用局部处理的边缘连接

​		**区域处理**
​		感兴趣的位置已知或可以确定，意味着响应的边缘图像中关于像素的区域成员的知识是可用的
​		多边形拟合算法迭代

​		必须指定两个起始点，所有点必须排序（顺时针或逆时针）
​		分析是开放还是闭合的曲线

​		选取起始点：选择点集中的最右边的点和最左边的点；寻找曲线的极端点

​		寻找一个多边形拟合开放和闭合曲线的算法：
​		1）令P是一个已排序序列，显然，这些点是一幅二值图像中的1值点。指定两个起始点A和B，它们是多边形的两个起始顶点
​		2）指定一个阈值T，以及两个空堆栈“开”（OPEN）和”闭“（CLOSED）
​		3）如果P中的点对应于一条闭合曲线，则把A放到”开“中，并把B放到”开“和”闭“中。如果点对应于一条开放曲线，则把A放到”开“中，而把B放到“闭”
​		4）计算从“闭”中最后一个顶点到“开”中最后一个顶点的线的参数
​		5）计算步骤4所得的直线至P中所有点的距离，序列把它们放到步骤4所得的两个顶点之间。选择具有最大距离D_max的点V_max（解决任意性问题）
​		6）如果D_max>T，则把V_max作为一个新顶点放在“开”堆栈的末尾。转步骤4
​		7）否则，从“开”中移除最后一个顶点，并把它作为“闭”的最后一个顶点插入
​		8）如果“开”非空，转步骤4
​		9）否则，退出。“闭”中的顶点就是拟合P中的点的多边形的顶点

​		用多边形近似连接边缘

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\多边形近似连接.PNG)

​		一幅图像的边界的多边形拟合

​		**使用霍夫变换的全局处理**
​		基于像素集是否位于指定形状的曲线上的方法
​		霍夫变换：
​		考虑xy平面上的一个点和斜截式形式为y_i=ax_i+b的一条直线。通过点(x_i, y_i)的直线有无数调，且对a和b是不同值，都满足方程。
​		但是考虑ab平面（参数空间），i和j在xy空间连线，但是在ab空间交于一点
​		解决a（斜率）无穷大的问题，使用法线表示：
$$
xcos\theta+ysin\theta=\rho
$$
​		霍夫变换计算上的魅力在于可将ρθ参数空间划分为所谓的累加单元

​		基本霍夫变换性质的说明
​		霍夫变换也适用于形如g(v, c)=0的任何函数
​		v是坐标向量，c是系数向量
​		霍夫变换有可能进一步推广到检测无简单解析表达式的曲线，如变换为灰度级图像那样的应用

​		基于霍夫变换的一种连接方法：
​		1）使用任何技术得到一幅二值图像
​		2）指定ρθ平面中的细分
​		3）对像素高度集中的地方检验其累加单元的数量
​		4）检验选中单元像素间的关系（主要针对连续性）

​		使用霍夫变换连接边缘

#### 10.3 阈值处理

​		**基础知识**
​		基于灰度值和/或灰度值的特性来将图像直接划分为区域
​		**灰度阈值处理基础**
​		直方图中用阈值T将几种模式分开，对象点，背景点
$$
g(x,y)=\begin{cases}
1, &f(x,y)>T\\
0, &f(x,y)\leq T
\end{cases}
$$
​		当T适用于整个图像，全局阈值处理
​		T在一幅图像上改变，可变阈值处理（局部阈值处理，区域阈值处理）
​		任何点处的T取决于邻域特性
​		如果取决于坐标本身，则可变阈值处理称为动态阈值处理或自适应阈值处理

​		多个T，双阈值

​		成功与否直接关系到可区分的直方图模式的谷的宽度和深度。影响波谷特性的关键因素是：
​		1）波峰间的间隔（波峰离得越远，分离这些模式的机会越好）
​		2）图像中的噪声内容（模式随噪声的增加而展宽）
​		3）物体和背景的相对尺寸
​		4）光源的均匀性
​		5）图像反射特性的均匀性

​		**图像阈值处理中噪声的作用**

​		**光照和反射的作用**
​		3种基本解决办法：
​		1）直接校正这种阴影模式（例如非均匀但固定的光照可用相反的模式与图像相乘来校正，相反的模式可以用一个恒定灰度的平坦表面成像来得到）
​		2）顶帽变换处理来尝试校正全局阴影模式（9.6未学）
​		3）可变阈值近似处理非均匀性

​		（理论上斜坡图像的直方图是均匀的，但是实际上实现完美的均匀性取决于图像的尺寸和灰度比特数）

​		**基本的全局阈值处理**
​		1）为全局阈值T选择一个初始值
​		2）用T分割图像。产生两组像素：G_1和G_2
​		3）对两组像素分别计算平均灰度值（均值）m_1和m_2
​		4）计算新阈值${T=\frac{1}{2}(m_1+m_2)}$
​		5）重复2-4，直到连续迭代中的T值间的差小于一个预定义的参数ΔT为止

​		全局阈值处理

​		**用Otsu方法的最佳全局阈值处理**
​		分类引入的平均误差最小
​		闭合形式的解，称为**贝叶斯决策规则**，以两个参数为基础：
​		每一类的灰度级的概率密度函数PDF和在给定应用中的每一类出现的概率
​		Otasu方法在类间方差最大的情况下是最佳的，完全以在一幅图像的直方图上执行计算为基础

​		分为两类C1和C2，分别计算分到两类中的概率，平均灰度值
​		归一化的无量纲矩阵，分母是全局方差，分子为类间方差
$$
\eta=\frac{\sigma_B^2}{\sigma_G^2}\\
\sigma_B^2=P_1(m_1-m_G)^2+P_2(m_2-m_G)^2\\
\sigma_B^2=P_1P_2(m_1-m_2)^2\\
=\frac{(m_GP_1-m)^2}{P_1(1-P_1)}
$$
​		找到最佳阈值k*，使得σ_B^2(k)最大化
​		如果多个k，习惯上是对k取平均

​		Otsu算法小结：
​		1）计算输入图像的归一化直方图，使用p_i，i=0,1,2,...,L-1表示该直方图的各个分量
​		2）计算累积和P_1(k)
​		3）计算累积均值m(k)
​		4）计算全局灰度均值m_G
​		5）计算类间方差${\sigma_B^2(k)}$
​		6）得到Otsu阈值${k^*}$，即使得到${\sigma_B^2(k)}$最大的k值。如果最大值不唯一，用相应检测到的各个最大值k的平均得到${k^*}$
​		7）在${k=k^*}$处计算得到可分性度量${\eta^*}$

​		使用Otsu方法的最佳全局阈值处理

​		**用图像平滑改善全局阈值处理**

​		**利用边缘改进全局阈值处理**
​		1）计算一幅边缘图像，无论是梯度的幅度还是拉普拉斯的绝对值都可以
​		2）指定一个阈值T
​		3）用阈值对图像进行阈值处理，产生一幅二值图像g_T。在从f中选取对应于“强”边缘像素的下一步中，该图像用做一幅模板图像
​		4）仅用f中对应于g_T中像素值为1的位置的像素计算直方图
​		5）用直方图全局地分割f，例如使用Otsu方法

​		如果T设置为小于边缘图像的最小值的任何值，则变成使用原始图像的直方图的全局阈值处理。
​		习惯上以百分比的形式来指定T值，百分比通常设置得较高，以便在计算中用梯度/拉普拉斯图像中的较少像素

​		用以梯度为基础的边缘信息改进全局阈值处理

​		用拉普拉斯为基础的边缘信息改进全局阈值处理

​		**多阈值处理**
​		带有两个阈值的阈值处理有时也称为滞后阈值处理
​		（省略均值和方差，类间方差的计算公式）
$$
g(x,y)=\begin{cases}
a,&f(x,y)\leq k_1^*\\
b,&k_1^*<f(x,y)\leq k_2^*\\
c,&f(x,y)>k_2^*
\end{cases}
$$
​		可分性度量
$$
\eta(k_1^*,k_2^*)=\frac{\sigma_B^2(k_1^*,k_2^*)}{\sigma_G^2}
$$
​		多个全局阈值处理

​		**可变阈值处理**
​		**图像分块**
​		可变阈值处理最简单的方法之一是把一幅图像分成不重叠的矩形。这种方法用于补偿光照和/或反射的不均匀性
​		选择的矩形要足够小，以便每个矩形的光照都近似是均匀的

​		通过图像分块的可变阈值处理
​		细分可能只包含物体或背景像素，导致方法失败

​		**基于局部图像特性的可变阈值处理**
​		在一幅图像中的每一点计算阈值，该阈值是以一个或多个在(x,y)邻域计算阈值，该阈值是以一个或多个在(x,y)邻域计算的特性为基础的
​		可变局部阈值的通用形式：
$$
T_{xy}=a\alpha_{xy}+bm_{xy}\\
T_{xy}=a\alpha_{xy}+bm_G
$$
​		基于局部图像特性的可变阈值处理

​		**使用移动平均**
​		以一幅图像的扫描行计算移动平均为基础的
​		新点处的移动平均（平均灰度）：
$$
m(k+1)=\frac{1}{n}\sum_{i=k+2-n}^{k+1}z_i=m(k)+\frac{1}{n}(z_{k+1}-z_{k-n})
$$
​		用移动平均的文档阈值处理
​		这种方法相对稳定，因为相同的n和b，都可以成功
​		对感兴趣的物体与图像尺寸相比较小（或较细）时，基于移动平均的阈值处理会工作得很好
​		打印图像和手写文本图像满足这一条件

​		**多变量阈值处理**
​		例如彩色成像RGB
​		体素

​		多变量阈值处理可视为一种距离计算
$$
g(x,y)=\begin{cases}
1, &D(z,a)<T\\
0, &其他
\end{cases}
$$
​		z是任意彩色点，a是平均彩色，D是距离测度
​		（注意0和1的选择和单变量（灰度）相反）

​		欧几里得距离
​		马氏距离（Mahalanobis）
​		（也就是在计算中增加协方差啦）

![](F:\学习笔记（敲字人）\数字图像处理的一些图片\多变量阈值处理.PNG)

### 本章后续部分暂无要求，不看



## * 第11章 表示和描述



## * 第12章 目标识别